!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("THREE")):"function"==typeof define&&define.amd?define("Jining3dMapLib",["THREE"],e):"object"==typeof exports?exports.Jining3dMapLib=e(require("THREE")):t.Jining3dMapLib=e(t.THREE)}(this,function(t){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1),e.MapWithColumn=i(2),e.MapWithFlow=i(29),e.ColorScale=i(33),e.LinearScale=i(34),e.webgl=i(35).webgl},function(t,e){"undefined"==typeof window.console&&(window.console={info:function(){},warn:function(){},error:function(){},log:function(){}}),"function"!=typeof Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e})},function(t,e,i){var n=(i(3),i(4)),o=(i(5),i(6)),r=i(18),s=i(27),a=Math.PI/180,c=function(t){o.call(this,t),this._stage3d.camera.position.set(1.040979539658803,-233.3660825660172,585.2495890199206),this._controls.target.set(-3.558668331040008,-71.01040694836026,-31.175877370524628),this._controls.update(),this._columns=[]};c.prototype=n(o.prototype,{constructor:c,_map:null,_columns:void 0,_initLight:function(){this._addLight(16777215,.5,800,0,100),this._addLight(16777215,.5,-800,0,100),this._addLight(16777215,.5,0,800,100),this._addLight(16777215,.5,0,-800,100),this._addLight(16777215,.75,0,0,800)},_initObject:function(){var t=this,e=new r;e.idField="name",e.mapData=this._parameters.mapData||i(28),e.strokeColor=this._parameters.strokeColor||10802930,e.fillColor=this._parameters.fillColor||15135484,e.labelFillColor=this._parameters.labelFillColor||5282240,e.labelStrokeColor=this._parameters.labelStrokeColor||0,e.highlightColor=this._parameters.highlightColor||16774836,e.scaleX=552.3,e.scaleY=612.8,e.scaleZ=10.1,this._map=e,this._stage3d.addObject(this._map),e.on("itemClick",function(e){t.dispatchEvent({type:"mapItemClick",mouseEvent:e.mouseEvent,index:e.index,feature:e.feature,item:e.data})}),e.on("itemMouseOut",function(e){t.dispatchEvent({type:"mapItemMouseOut",mouseEvent:e.mouseEvent,item:e.data})}),e.on("itemMouseOver",function(e){t.dispatchEvent({type:"mapItemMouseOver",mouseEvent:e.mouseEvent,index:e.index,feature:e.feature,item:e.data})}),this.columnData=this._parameters.columnData||[],this.mapItemData=this._parameters.mapItemData||[]},get mapItemData(){return this._map.itemData},set mapItemData(t){this._map.itemData=t},_columnData:void 0,get columnData(){return this._columnData},set columnData(t){this._columnData=t;var e=this;this._columns&&this._columns.forEach(function(t){t.dispatcher=null,t.disappear(0,500,function(){e._stage3d.removeObject(this)})}),this._columns=[];var i=0;this._columnData.forEach(function(t){var n=e._map.getFeature(t.id);if(!n)return void console.warn('Can NOT find map feature with id "'+t.id+'": ',t);var o=e._map.lonLatToXY(n.boundingBox.centerX,n.boundingBox.centerY),r=new s;r.dispatcher=e,r.item=t,r.renderable=!0,r.interactive=!0,r.height=t.height,r.numSides=4,r.radiusTop=t.size,r.radiusBottom=t.size,r.position.x=o.x,r.position.y=o.y+2*t.size,r.position.z=e._map.scaleZ,r.rotation.x=90*a,r.color=t.color,r.emphasisColor=11757311,r.style=1,r.appear(i,800),e._stage3d.addObject(r),e._columns.push(r),i+=10})}}),t.exports=c},function(e,i){e.exports=t},function(t,e){function i(){if(arguments.length<1)return null;for(var t=Object.create(arguments[0]),e=1;e<arguments.length;e++)n(t,arguments[e]);return t}function n(t,e){if(e&&e!==Object.prototype){var i=Object.getOwnPropertyNames(e);i.forEach(function(i){if("constructor"==i)return!0;var n=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,n)}),n(t,Object.getPrototypeOf(e))}}t.exports=i},function(t,e){function i(){}i.prototype={constructor:i,_stage3d:null,get stage3d(){return this._stage3d},_interactive:!1,get interactive(){return this._interactive},set interactive(t){this._interactive=t,this._stage3d&&(this._interactive?this._stage3d.interactiveManager.add(this,this.useFaces):this._stage3d.interactiveManager.remove(this))},_useFaces:!1,get useFaces(){return this._useFaces},set useFaces(t){this._useFaces=t},_renderable:!1,get renderable(){return this._renderable},set renderable(t){this._renderable=t,this._stage3d&&(this._renderable?this._stage3d.renderableManager.add(this):this._stage3d.renderableManager.remove(this))},addObject:function(t){t&&(t._stage3d=this._stage3d,"function"==typeof t._addedToStage&&t._addedToStage(),this.add(t))},removeObject:function(t){t&&(this.remove(t),"function"==typeof t._removedFromStage&&t._removedFromStage(),t._stage3d=null)},_addedToStage:function(){var t=this;this._stage3d&&(this.interactive&&this._stage3d.interactiveManager.add(this,this.useFaces),this.renderable&&this._stage3d.renderableManager.add(this),this.children instanceof Array&&this.children.forEach(function(e){e._stage3d=t._stage3d,"function"==typeof e._addedToStage&&e._addedToStage()}))},_removedFromStage:function(){this._stage3d&&(this._stage3d.interactiveManager.remove(this),this._stage3d.renderableManager.remove(this),this.children instanceof Array&&this.children.forEach(function(t){"function"==typeof t._removedFromStage&&t._removedFromStage(),t._stage3d=null}))}},t.exports=i},function(t,e,i){var n=i(3),o=i(7),r=i(4),s=i(9),a=i(10),c=i(13);i(17);var h=function(t){this._parameters=t||{},this._initEnv(),this._initialized=!0};h.prototype=r(s.prototype,{constructor:h,_parameters:void 0,_initialized:!1,_stage3d:void 0,_timer:void 0,_controls:void 0,_addLight:function(t,e,i,o,r,s,a){var c=new n.PointLight(t,e);if(c.position.set(i,o,r),this._stage3d.scene.add(c),s){var h=new n.Mesh(new n.SphereGeometry(a||1),new n.MeshBasicMaterial({color:t}));h.position.set(i,o,r),this._stage3d.scene.add(h)}},_initEnv:function(){this._initialized||(this._initEngine(),this._initLight(),this._initControl(),this._initObject())},_initEngine:function(){var t=this;this._stage3d=new a,this._stage3d.interactiveManager.useOctree=!1,this._stage3d.camera.position.set(74/255,85/255,83/255),this._timer=new c(c.REQUEST_ANIMATION_FRAME),this._timer.on("timer",function(){o.update(),t._stage3d.render()}),this._timer.start()},_initLight:function(){var t=!1;this._addLight(16777215,.4,86/255,73/255,83/255,t)},_initControl:function(){this._controls=new n.OrbitControls(this._stage3d.camera,this._stage3d.domElement),this._controls.enableDamping=!0,this._controls.dampingFactor=.25,this._controls.rotateSpeed=.35,this._controls.minDistance=100,this._controls.maxDistance=1600;var t=this;this._stage3d.domElement.addEventListener("dblclick",function(e){e.shiftKey&&(console.log("DEBUG: "),console.log("camera.position",t._stage3d.camera.position.x,t._stage3d.camera.position.y,t._stage3d.camera.position.z),console.log("control.target",t._controls.target.x,t._controls.target.y,t._controls.target.z))})},_initObject:function(){},get domElement(){return this._stage3d.domElement},start:function(){this._timer.start()},stop:function(){this._timer.stop()},appear:function(t,e,i){},disappear:function(t,e,i){},resize:function(t,e){this._stage3d.width=t,this._stage3d.height=e},capture:function(t,e){this._stage3d.capture(t,e)}}),t.exports=h},function(t,e,i){var n,o;(function(i){"use strict";var r=r||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){e=t.indexOf(e),-1!==e&&t.splice(e,1)},update:function(e,i){if(0===t.length)return!1;var n=0;for(e=void 0!==e?e:r.now();n<t.length;)t[n].update(e)||i?n++:t.splice(n,1);return!0}}}();(function(){r.now=void 0===this.window&&void 0!==this.process?function(){var t=i.hrtime();return 1e3*t[0]+t[1]/1e6}:void 0!==this.window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now.bind(window.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()}}).call(this),r.Tween=function(t){var e,i,n={},o={},s={},a=1e3,c=0,h=!1,u=!1,l=0,d=null,f=r.Easing.Linear.None,p=r.Interpolation.Linear,m=[],_=null,v=!1,g=null,b=null,y=null;for(i in t)n[i]=parseFloat(t[i],10);this.to=function(t,e){return void 0!==e&&(a=e),o=t,this},this.start=function(e){r.add(this),u=!0,v=!1,d=void 0!==e?e:r.now(),d+=l;for(var i in o){if(o[i]instanceof Array){if(0===o[i].length)continue;o[i]=[t[i]].concat(o[i])}void 0!==t[i]&&(n[i]=t[i],!1==n[i]instanceof Array&&(n[i]*=1),s[i]=n[i]||0)}return this},this.stop=function(){return u?(r.remove(this),u=!1,null!==y&&y.call(t,t),this.stopChainedTweens(),this):this},this.end=function(){return this.update(d+a),this},this.stopChainedTweens=function(){for(var t=0,e=m.length;t<e;t++)m[t].stop()},this.delay=function(t){return l=t,this},this.repeat=function(t){return c=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return h=t,this},this.easing=function(t){return f=t,this},this.interpolation=function(t){return p=t,this},this.chain=function(){return m=arguments,this},this.onStart=function(t){return _=t,this},this.onUpdate=function(t){return g=t,this},this.onComplete=function(t){return b=t,this},this.onStop=function(t){return y=t,this},this.update=function(i){var r,u,y;if(i<d)return!0;!1===v&&(null!==_&&_.call(t,t),v=!0),u=(i-d)/a,u=1<u?1:u,y=f(u);for(r in o)if(void 0!==n[r]){var O=n[r]||0,j=o[r];j instanceof Array?t[r]=p(j,y):("string"==typeof j&&(j="+"===j.charAt(0)||"-"===j.charAt(0)?O+parseFloat(j,10):parseFloat(j,10)),"number"==typeof j&&(t[r]=O+(j-O)*y))}if(null!==g&&g.call(t,y),1===u){if(!(0<c)){for(null!==b&&b.call(t,t),i=0,r=m.length;i<r;i++)m[i].start(d+a);return!1}isFinite(c)&&c--;for(r in s)"string"==typeof o[r]&&(s[r]+=parseFloat(o[r],10)),h&&(u=s[r],s[r]=o[r],o[r]=u),n[r]=s[r];d=void 0!==e?i+e:i+l}return!0}},r.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return 1>(t*=2)?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return 1>(t*=2)?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:1>(t*=2)?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return 1>(t*=2)?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,1>t?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){return 1>(t*=2)?.5*t*t*(3.5949095*t-2.5949095):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)}},Bounce:{In:function(t){return 1-r.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return.5>t?.5*r.Easing.Bounce.In(2*t):.5*r.Easing.Bounce.Out(2*t-1)+.5}}},r.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),s=r.Interpolation.Utils.Linear;return 0>e?s(t[0],t[1],n):1<e?s(t[i],t[i-1],i-n):s(t[o],t[o+1>i?i:o+1],n-o)},Bezier:function(t,e){for(var i=0,n=t.length-1,o=Math.pow,s=r.Interpolation.Utils.Bernstein,a=0;a<=n;a++)i+=o(1-e,n-a)*o(e,a)*t[a]*s(n,a);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,o=Math.floor(n),s=r.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(0>e&&(o=Math.floor(n=i*(1+e))),s(t[(o-1+i)%i],t[o],t[(o+1)%i],t[(o+2)%i],n-o)):0>e?t[0]-(s(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[i]-(s(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):s(t[o?o-1:0],t[o],t[i<o+1?i:o+1],t[i<o+2?i:o+2],n-o)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=r.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:function(){var t=[1];return function(e){var i=1;if(t[e])return t[e];for(var n=e;1<n;n--)i*=n;return t[e]=i}}(),CatmullRom:function(t,e,i,n,o){t=.5*(i-t),n=.5*(n-e);var r=o*o;return(2*e-2*i+t+n)*o*r+(-3*e+3*i-2*t-n)*r+t*o+e}}},function(i){n=[],o=function(){return r}.apply(e,n),!(void 0!==o&&(t.exports=o))}(this)}).call(e,i(8))},function(t,e){function i(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(u===setTimeout)return setTimeout(t,0);if((u===i||!u)&&setTimeout)return u=setTimeout,setTimeout(t,0);try{return u(t,0)}catch(e){try{return u.call(null,t,0)}catch(e){return u.call(this,t,0)}}}function r(t){if(l===clearTimeout)return clearTimeout(t);if((l===n||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(t);try{return l(t)}catch(e){try{return l.call(null,t)}catch(e){return l.call(this,t)}}}function s(){m&&f&&(m=!1,f.length?p=f.concat(p):_=-1,p.length&&a())}function a(){if(!m){var t=o(s);m=!0;for(var e=p.length;e;){for(f=p,p=[];++_<e;)f&&f[_].run();_=-1,e=p.length}f=null,m=!1,r(t)}}function c(t,e){this.fun=t,this.array=e}function h(){}var u,l,d=t.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:i}catch(t){u=i}try{l="function"==typeof clearTimeout?clearTimeout:n}catch(t){l=n}}();var f,p=[],m=!1,_=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];p.push(new c(t,e)),1!==p.length||m||o(a)},c.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},function(t,e){function i(t){if(t&&!(t instanceof i))throw new Error("Illegal target.");this._target=t}i.prototype={constructor:i,_target:null,addEventListener:function(t,e,i){var n=this;if(!t||"function"!=typeof e)throw new Error("Illegal parameters.");void 0===n._mapKTypeVListenerTokens&&(n._mapKTypeVListenerTokens={});var o=n._mapKTypeVListenerTokens[t];void 0===o&&(o=[],n._mapKTypeVListenerTokens[t]=o);var r={listener:e,thisArg:i};o.push(r)},removeEventListener:function(t,e){var i=this;if(!t||"function"!=typeof e)throw new Error("Illegal parameters.");if(void 0!==i._mapKTypeVListenerTokens){var n=i._mapKTypeVListenerTokens[t];if(void 0!==n){for(var o=-1,r=null,s=0;s<n.length;s++)if(r=n[s],r.listener===e){o=s;break}o!==-1&&(n.splice(o,1),delete r.listener,delete r.thisArg),n.length<1&&delete i._mapKTypeVListenerTokens[t]}}},removeEventListeners:function(t){var e=this;if(void 0!==e._mapKTypeVListenerTokens)if(void 0===t)for(var i in e._mapKTypeVListenerTokens)e._mapKTypeVListenerTokens.hasOwnProperty(i)&&e.removeEventListeners(i);else{var n=e._mapKTypeVListenerTokens[t];if(void 0===n)return;for(var o=0;o<n.length;o++){var r=n[o];delete r.listener,delete r.thisArg}delete e._mapKTypeVListenerTokens[t]}},hasEventListener:function(t,e){var i=this;if(!t)throw new Error("Illegal parameters.");if(void 0===i._mapKTypeVListenerTokens)return!1;var n=i._mapKTypeVListenerTokens[t];if(void 0===e)return void 0!==n;for(var o=0;o<n.length;o++){var r=n[o];if(r.listener===e)return!0}return!1},dispatchEvent:function(t){var e=this;if(!t||!t.type)throw new Error("Illegal parameter event: "+t);if(t instanceof Event){console.warn("It recommends to use Object instead of Event class.");var i={};for(var n in t)t[n]instanceof Function||(i[n]=t[n]);t=i}if(void 0!==e._mapKTypeVListenerTokens){var o=e._mapKTypeVListenerTokens[t.type];if(void 0!==o){var r=this._target||e;t.target=r;for(var s=0;s<o.length;s++){var a=o[s];a.listener.call(a.thisArg,t)}}}},on:function(t,e,i){this.addEventListener(t,e,i)},off:function(t){this.removeEventListeners(t)},fire:function(t){this.dispatchEvent(t)}},t.exports=i},function(t,e,i){function n(){this._scene=new r.Scene,this._camera=new r.PerspectiveCamera(75,this._width/this._height,1,1e4),this._renderer=new r.WebGLRenderer({antialias:!0,alpha:!0}),"number"==typeof window.devicePixelRatio&&this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setClearColor(0,0),this._renderer.setSize(this._width,this._height),this._interactiveManager=new a,this._interactiveManager.stage3d=this,this._renderableManager=new c}var o=i(4),r=i(3),s=i(11),a=i(14),c=i(16);n.prototype=o(s.prototype,{constructor:n,_captureExecutor:null,_scene:null,get scene(){return this._scene},set scene(t){this._scene=t},_camera:null,get camera(){return this._camera},set camera(t){this._camera=t},_renderer:null,get renderer(){return this._renderer},set renderer(t){this._renderer=t},_interactiveManager:null,get interactiveManager(){return this._interactiveManager},set interactiveManager(t){this._interactiveManager=t},_renderableManager:null,get renderableManager(){return this._renderableManager},set renderableManager(t){this._renderableManager=t},get domElement(){return this._renderer?this._renderer.domElement:null},get stageX(){return this._interactiveManager?this._interactiveManager.stageX:0},get stageY(){return this._interactiveManager?this._interactiveManager.stageY:0},updateDisplayList:function(){this._camera instanceof r.PerspectiveCamera?this._camera.aspect=this._width/this._height:this._camera instanceof r.OrthographicCamera&&(this._camera.left=this._width/-2,this._camera.right=this._width/2,this._camera.top=this._height/2,this._camera.bottom=this._height/-2),this._camera.updateProjectionMatrix(),this._renderer.setSize(this._width,this._height)},capture:function(t,e){if("function"==typeof t){var i=this;this._captureExecutor=function(){t(i.domElement.toDataURL(e||"image/png")),i._captureExecutor=null}}},render:function(){this._renderableManager.update(),this._renderer.render(this._scene,this._camera),"function"==typeof this._captureExecutor&&this._captureExecutor(),this._interactiveManager.update()},addObject:function(t){t._stage3d=this,"function"==typeof t._addedToStage&&t._addedToStage(),this.scene.add(t)},removeObject:function(t){this.scene.remove(t),"function"==typeof t._removedFromStage&&t._removedFromStage(),t._stage3d=null}}),t.exports=n},function(t,e,i){function n(){r.call(this)}var o=i(4),r=i(9),s=i(12);n.prototype=o(r.prototype,{constructor:n,_invalidatePropertiesFlag:!1,_invalidateSizeFlag:!1,_invalidateDisplayListFlag:!1,_x:0,get x(){return this._x},set x(t){this._x!=t&&(this._x=t,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},_y:0,get y(){return this._y},set y(t){this._y!=t&&(this._y=t,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},_width:100,get width(){return this._width},set width(t){this._width!=t&&(this._width=t,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},_height:100,get height(){return this._height},set height(t){this._height!=t&&(this._height=t,this.invalidateProperties(),this.invalidateSize(),this.invalidateDisplayList())},initialize:function(){},invalidateProperties:function(){this._invalidatePropertiesFlag||(this._invalidatePropertiesFlag=!0,s.getInstance().invalidateProperties(this))},invalidateSize:function(){this._invalidateSizeFlag||(this._invalidateSizeFlag=!0,s.getInstance().invalidateSize(this))},invalidateDisplayList:function(){this._invalidateDisplayListFlag||(this._invalidateDisplayListFlag=!0,s.getInstance().invalidateDisplayList(this))},validateNow:function(){s.getInstance().validateClient(this)},validateProperties:function(){this._invalidatePropertiesFlag&&(this.commitProperties(),this._invalidatePropertiesFlag=!1)},validateSize:function(){this._invalidateSizeFlag&&(this.measure(),this._invalidateSizeFlag=!1)},validateDisplayList:function(){this._invalidateDisplayListFlag&&(this.updateDisplayList(),this._invalidateDisplayListFlag=!1)},commitProperties:function(){},measure:function(){},updateDisplayList:function(){},setStyle:function(){}}),t.exports=n},function(t,e,i){function n(){Object.call(this),this._timerCompleteHandler=this._timerCompleteHandler.bind(this),this._timer=new o(o.REQUEST_ANIMATION_FRAME,1),this._timer.on("timerComplete",this._timerCompleteHandler,this)}var o=i(13);n.prototype={constructor:n,_initialized:!1,_timer:null,_invalidatePropertiesQueue:[],_invalidatePropertiesFlag:!1,_invalidateSizeQueue:[],_invalidateSizeFlag:!1,_invalidateDisplayListQueue:[],_invalidateDisplayListFlag:!1,_timerCompleteHandler:function(t){this._invalidatePropertiesFlag&&this._validateProperties(),this._invalidateSizeFlag&&this._validateSize(),this._invalidateDisplayListFlag&&this._validateDisplayList()},invalidateProperties:function(t){t&&"function"==typeof t.validateProperties&&(this._invalidatePropertiesQueue.push(t),this._invalidatePropertiesFlag=!0,this._timer.running()||this._timer.start())},invalidateSize:function(t){t&&"function"==typeof t.validateSize&&(this._invalidateSizeQueue.push(t),this._invalidateSizeFlag=!0,this._timer.running()||this._timer.start())},invalidateDisplayList:function(t){t&&"function"==typeof t.validateDisplayList&&(this._invalidateDisplayListQueue.push(t),this._invalidateDisplayListFlag=!0,this._timer.running()||this._timer.start())},validateClient:function(t){if(!t)throw new Error("Target is NULL.");"function"==typeof t.validateProperties&&t.validateProperties(),"function"==typeof t.validateSize&&t.validateSize(),"function"==typeof t.validateDisplayList&&t.validateDisplayList()},_validateProperties:function(){for(;this._invalidatePropertiesQueue.length>0;){var t=this._invalidatePropertiesQueue.pop();t.validateProperties()}this._invalidatePropertiesFlag=!1},_validateSize:function(){for(;this._invalidateSizeQueue.length>0;){var t=this._invalidateSizeQueue.pop();t.validateSize()}this._invalidateSizeFlag=!1},_validateDisplayList:function(){for(;this._invalidateDisplayListQueue.length>0;){var t=this._invalidateDisplayListQueue.pop();t.validateDisplayList()}this._invalidateDisplayListFlag=!1}};var r=new n;n.getInstance=function(){return r},t.exports=n},function(t,e,i){function n(t,e){r.call(this),this._run=this._run.bind(this),this._setIntervalHandler=this._setIntervalHandler.bind(this),this._requestAnimationFrameHandler=this._requestAnimationFrameHandler.bind(this),this.delay(t),this.repeatCount(e||0)}var o=i(4),r=i(9);n.REQUEST_ANIMATION_FRAME=-4132,n.prototype=o(r.prototype,{constructor:n,_delay:void 0,_repeatCount:0,_currentCount:0,_intervalId:void 0,_setIntervalHandler:function(){this._run()},_requestAnimationFrameFlag:!1,_requestAnimationFrameCount:0,_requestAnimationFrameHandler:function(){1==this._requestAnimationFrameCount&&this._run(),this._requestAnimationFrameCount<1&&this._requestAnimationFrameCount++,this._requestAnimationFrameFlag&&requestAnimationFrame(this._requestAnimationFrameHandler)},_run:function(){return 0!=this._repeatCount&&this._currentCount>=this._repeatCount?(this.stop(),void this.fire({type:"timerComplete"})):(this._currentCount++,void this.fire({type:"timer"}))},delay:function(t){if(0==arguments.length)return this._delay;if(this._delay!=t){if(isNaN(t)||!isFinite(t)||t<=0&&t!=n.REQUEST_ANIMATION_FRAME)throw new Error("Illegal delay value: "+t);return this._delay=t,this.running()&&(this.stop(),this.start()),this}},repeatCount:function(t){if(0==arguments.length)return this._repeatCount;if(this._repeatCount!=t){if(isNaN(t)||!isFinite(t)||t<0)throw new Error("Illegal repeat count value: "+t);return this._repeatCount=t,this}},currentCount:function(){return this._currentCount},running:function(){return"number"==typeof this._intervalId||this._requestAnimationFrameFlag},reset:function(){this.stop(),this._currentCount=0},start:function(){this.running()||(this._delay==n.REQUEST_ANIMATION_FRAME&&"function"==typeof requestAnimationFrame?(this._requestAnimationFrameFlag=!0,requestAnimationFrame(this._requestAnimationFrameHandler)):this._delay>0&&(this._intervalId=setInterval(this._setIntervalHandler,this._delay)))},stop:function(){this.running()&&(clearInterval(this._intervalId),this._intervalId=null,this._requestAnimationFrameFlag=!1,this._requestAnimationFrameCount=0)}}),t.exports=n},function(t,e,i){function n(){this._objects={},this._objectList=[],this._numObjects=0,this._octree=new o.Octree({undeferred:!1,depthMax:1/0,objectsThreshold:8,overlapPct:.15}),this._mouse={},this._raycaster=new o.Raycaster,this._domElementMouseMoveHandler=this._domElementMouseMoveHandler.bind(this),this._domElementClickHandler=this._domElementClickHandler.bind(this),this._domElementDoubleClickHandler=this._domElementDoubleClickHandler.bind(this)}var o=i(3);i(15),n.prototype={constructor:n,_objects:null,_objectList:null,_numObjects:0,_octree:null,_mouse:null,_object:null,_faceIndex:null,_index:null,_raycaster:null,get raycaster(){return this._raycaster},set raycaster(t){this._raycaster=t},_stage3d:null,get stage3d(){return this._stage3d},set stage3d(t){this._stage3d!=t&&(this._stage3d&&(this._stage3d.domElement.removeEventListener("mousemove",this._domElementMouseMoveHandler),this._stage3d.domElement.removeEventListener("click",this._domElementClickHandler),this._stage3d.domElement.removeEventListener("dblclick",this._domElementDoubleClickHandler),this._stage3d=null),this._stage3d=t,this._stage3d&&(this._stage3d.domElement.addEventListener("mousemove",this._domElementMouseMoveHandler),this._stage3d.domElement.addEventListener("click",this._domElementClickHandler),this._stage3d.domElement.addEventListener("dblclick",this._domElementDoubleClickHandler)))},_useOctree:!1,get useOctree(){return this._useOctree},set useOctree(t){this._useOctree=t},get stageX(){return this._mouse.stageX},get stageY(){return this._mouse.stageY},_getObjectId:function(t){return t.id+":"+t.uuid},_domElementMouseMoveHandler:function(t){t.preventDefault(),this._mouse.x=t.offsetX/this._stage3d.width*2-1,this._mouse.y=2*-(t.offsetY/this._stage3d.height)+1,this._mouse.stageX=t.pageX,this._mouse.stageY=t.pageY,this._mouse.event=t,this.pick(t)},_domElementClickHandler:function(t){this.pick(t)},_domElementDoubleClickHandler:function(t){this.pick(t)},add:function(t,e){var i=this._getObjectId(t);this.contains(i)||(this._objects[i]=t,this._useOctree?this._octree.add(t,{useFaces:e}):this._objectList.push(t),this._numObjects++)},remove:function(t){var e=this._getObjectId(t);if(this.contains(e)){delete this._objects[e];var i=this._objectList.indexOf(t);i!=-1&&this._objectList.splice(i,1),this._octree.remove(t),this._numObjects--}},contains:function(t){return t instanceof o.Object3D&&(t=this._getObjectId(t)),"undefined"!=typeof this._objects[t]},update:function(){this._useOctree&&this._octree.update()},pick:function(t){if(!this._raycaster||!this._stage3d||this._numObjects<1)return null;if(this._raycaster.setFromCamera(this._mouse,this._stage3d.camera),this._useOctree)var e=this._octree.search(this._raycaster.ray.origin,this._raycaster.ray.far,!0,this._raycaster.ray.direction),i=this._raycaster.intersectOctreeObjects(e);else var i=this._raycaster.intersectObjects(this._objectList);if(i.length>0){this._useOctree&&i.sort(function(t,e){return t.distance>e.distance?1:-1});var n=i[0];t&&(t.face=n.face,t.index=n.index,t.faceIndex=n.faceIndex),this._object!=n.object?(this._object&&"function"==typeof this._object.mouseOut&&this._object.mouseOut(t),this._object=n.object,"function"==typeof this._object.mouseOver&&this._object.mouseOver(t)):this._object.useFaces&&this._index!=n.index&&(this._index=n.index,"function"==typeof this._object.mouseOver&&this._object.mouseOver(t)),t&&("click"==t.type&&"function"==typeof this._object.click?this._object.click(t):"dblclick"==t.type&&"function"==typeof this._object.doubleClick&&this._object.doubleClick(t)),this._stage3d.domElement.style.cursor="pointer"}else this._object&&"function"==typeof this._object.mouseOut&&this._object.mouseOut(t),this._object=null,this._faceIndex=null,this._stage3d.domElement.style.cursor="default";return i}},t.exports=n},function(t,e,i){var n=i(3);!function(t){"use strict";function e(t){return!isNaN(t)&&isFinite(t)}function i(t){return"[object Array]"===Object.prototype.toString.call(t)}function n(t){return t?i(t)!==!0?[t]:t:[]}function o(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i;return-1}function r(t,e,i){for(var n=0,o=t.length;n<o;n++)if(t[n][e]===i)return n;return-1}t.Octree=function(i){i=i||{},i.tree=this,this.nodeCount=0,this.INDEX_INSIDE_CROSS=-1,this.INDEX_OUTSIDE_OFFSET=2,this.INDEX_OUTSIDE_POS_X=e(i.INDEX_OUTSIDE_POS_X)?i.INDEX_OUTSIDE_POS_X:0,this.INDEX_OUTSIDE_NEG_X=e(i.INDEX_OUTSIDE_NEG_X)?i.INDEX_OUTSIDE_NEG_X:1,this.INDEX_OUTSIDE_POS_Y=e(i.INDEX_OUTSIDE_POS_Y)?i.INDEX_OUTSIDE_POS_Y:2,this.INDEX_OUTSIDE_NEG_Y=e(i.INDEX_OUTSIDE_NEG_Y)?i.INDEX_OUTSIDE_NEG_Y:3,this.INDEX_OUTSIDE_POS_Z=e(i.INDEX_OUTSIDE_POS_Z)?i.INDEX_OUTSIDE_POS_Z:4,this.INDEX_OUTSIDE_NEG_Z=e(i.INDEX_OUTSIDE_NEG_Z)?i.INDEX_OUTSIDE_NEG_Z:5,this.INDEX_OUTSIDE_MAP=[],this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X]={index:this.INDEX_OUTSIDE_POS_X,count:0,x:1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X]={index:this.INDEX_OUTSIDE_NEG_X,count:0,x:-1,y:0,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y]={index:this.INDEX_OUTSIDE_POS_Y,count:0,x:0,y:1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y]={index:this.INDEX_OUTSIDE_NEG_Y,count:0,x:0,y:-1,z:0},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z]={index:this.INDEX_OUTSIDE_POS_Z,count:0,x:0,y:0,z:1},this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z]={index:this.INDEX_OUTSIDE_NEG_Z,count:0,x:0,y:0,z:-1},this.FLAG_POS_X=1<<this.INDEX_OUTSIDE_POS_X+1,this.FLAG_NEG_X=1<<this.INDEX_OUTSIDE_NEG_X+1,this.FLAG_POS_Y=1<<this.INDEX_OUTSIDE_POS_Y+1,this.FLAG_NEG_Y=1<<this.INDEX_OUTSIDE_NEG_Y+1,this.FLAG_POS_Z=1<<this.INDEX_OUTSIDE_POS_Z+1,this.FLAG_NEG_Z=1<<this.INDEX_OUTSIDE_NEG_Z+1,this.utilVec31Search=new t.Vector3,this.utilVec32Search=new t.Vector3,this.scene=i.scene,this.scene&&(this.visualGeometry=new t.BoxGeometry(1,1,1),this.visualMaterial=new t.MeshBasicMaterial({color:16711782,wireframe:!0,wireframeLinewidth:1})),this.objects=[],this.objectsMap={},this.objectsData=[],this.objectsDeferred=[],this.depthMax=e(i.depthMax)?i.depthMax:1/0,this.objectsThreshold=e(i.objectsThreshold)?i.objectsThreshold:8,this.overlapPct=e(i.overlapPct)?i.overlapPct:.15,this.undeferred=i.undeferred||!1,this.root=i.root instanceof t.OctreeNode?i.root:new t.OctreeNode(i)},t.Octree.prototype={update:function(){if(this.objectsDeferred.length>0){for(var t=0,e=this.objectsDeferred.length;t<e;t++){var i=this.objectsDeferred[t];this.addDeferred(i.object,i.options)}this.objectsDeferred.length=0}},add:function(t,e){this.undeferred?(this.updateObject(t),this.addDeferred(t,e)):this.objectsDeferred.push({object:t,options:e})},addDeferred:function(e,i){var n,o,r,s,a,c,h;if(e instanceof t.OctreeObjectData&&(e=e.object),e.uuid||(e.uuid=t.Math.generateUUID()),!this.objectsMap[e.uuid])if(this.objects.push(e),this.objectsMap[e.uuid]=e,i&&(a=i.useFaces,h=i.useVertices),h===!0)for(r=e.geometry,c=r.vertices,n=0,o=c.length;n<o;n++)this.addObjectData(e,c[n]);else if(a===!0)for(r=e.geometry,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 s=r.faces,n=0,o=s.length;n<o;n++)this.addObjectData(e,s[n]);else this.addObjectData(e)},addObjectData:function(e,i){var n=new t.OctreeObjectData(e,i);this.objectsData.push(n),this.root.addObject(n)},remove:function(e){var i,n,s,a,c=e;if(e instanceof t.OctreeObjectData&&(e=e.object),this.objectsMap[e.uuid]){if(this.objectsMap[e.uuid]=void 0,s=o(this.objects,e),s!==-1)for(this.objects.splice(s,1),a=this.root.removeObject(c),i=0,n=a.length;i<n;i++)c=a[i],s=o(this.objectsData,c),s!==-1&&this.objectsData.splice(s,1)}else this.objectsDeferred.length>0&&(s=r(this.objectsDeferred,"object",e),s!==-1&&this.objectsDeferred.splice(s,1))},extend:function(e){var i,n,o,r;if(e instanceof t.Octree)for(o=e.objectsData,i=0,n=o.length;i<n;i++)r=o[i],this.add(r,{useFaces:r.faces,useVertices:r.vertices})},rebuild:function(){var e,i,n,o,r,s,a=[];for(e=0,i=this.objectsData.length;e<i;e++)o=this.objectsData[e],n=o.node,o.update(),n instanceof t.OctreeNode&&!o.positionLast.equals(o.position)&&(s=o.indexOctant,r=n.getOctantIndex(o),r!==s&&a.push(o));for(e=0,i=a.length;e<i;e++)o=a[e],o.node.removeObject(o),this.root.addObject(o)},updateObject:function(t){var e,i,n,o,r=[t];for(n=t.parent;n;)r.push(n),n=n.parent;for(e=0,i=r.length;e<i;e++)n=r[e],n.matrixWorldNeedsUpdate===!0&&(o=n);"undefined"!=typeof o&&o.updateMatrixWorld()},search:function(e,i,n,r){var s,a,c,h,u,l,d,f,p,m,_;for(h=[].concat(this.root.objects),i>0||(i=Number.MAX_VALUE),r instanceof t.Vector3&&(r=this.utilVec31Search.copy(r).normalize(),_=this.utilVec32Search.set(1,1,1).divide(r)),s=0,a=this.root.nodesIndices.length;s<a;s++)c=this.root.nodesByIndex[this.root.nodesIndices[s]],h=c.search(e,i,h,r,_);if(n===!0)for(d=[],p=[],s=0,a=h.length;s<a;s++)u=h[s],l=u.object,m=o(p,l),m===-1?(f={object:l,faces:[],vertices:[]},d.push(f),p.push(l)):f=d[m],u.faces?f.faces.push(u.faces):u.vertices&&f.vertices.push(u.vertices);else d=h;return d},setRoot:function(e){e instanceof t.OctreeNode&&(this.root=e,this.root.updateProperties())},getDepthEnd:function(){return this.root.getDepthEnd()},getNodeCountEnd:function(){return this.root.getNodeCountEnd()},getObjectCountEnd:function(){return this.root.getObjectCountEnd()},toConsole:function(){this.root.toConsole()}},t.OctreeObjectData=function(e,i){this.object=e,i instanceof t.Face3?(this.faces=i,this.face3=!0,this.utilVec31FaceBounds=new t.Vector3):i instanceof t.Vector3&&(this.vertices=i),this.radius=0,this.position=new t.Vector3,this.object instanceof t.Object3D&&this.update(),this.positionLast=this.position.clone()},t.OctreeObjectData.prototype={update:function(){this.face3?(this.radius=this.getFace3BoundingRadius(this.object,this.faces),this.position.copy(this.faces.centroid).applyMatrix4(this.object.matrixWorld)):this.vertices?(this.radius=this.object.material.size||1,this.position.copy(this.vertices).applyMatrix4(this.object.matrixWorld)):this.object.geometry?(null===this.object.geometry.boundingSphere&&this.object.geometry.computeBoundingSphere(),this.radius=this.object.geometry.boundingSphere.radius,this.position.copy(this.object.geometry.boundingSphere.center).applyMatrix4(this.object.matrixWorld)):(this.radius=this.object.boundRadius,this.position.setFromMatrixPosition(this.object.matrixWorld)),this.radius=this.radius*Math.max(this.object.scale.x,this.object.scale.y,this.object.scale.z)},getFace3BoundingRadius:function(e,i){void 0===i.centroid&&(i.centroid=new t.Vector3);var n,o=e.geometry||e,r=o.vertices,s=i.centroid,a=r[i.a],c=r[i.b],h=r[i.c],u=this.utilVec31FaceBounds;return s.addVectors(a,c).add(h).divideScalar(3),n=Math.max(u.subVectors(s,a).length(),u.subVectors(s,c).length(),u.subVectors(s,h).length())}},t.OctreeNode=function(e){this.utilVec31Branch=new t.Vector3,this.utilVec31Expand=new t.Vector3,this.utilVec31Ray=new t.Vector3,e=e||{},e.tree instanceof t.Octree?this.tree=e.tree:e.parent instanceof t.OctreeNode!=!0&&(e.root=this,this.tree=new t.Octree(e)),this.id=this.tree.nodeCount++,this.position=e.position instanceof t.Vector3?e.position:new t.Vector3,this.radius=e.radius>0?e.radius:1,this.indexOctant=e.indexOctant,this.depth=0,this.reset(),this.setParent(e.parent),this.overlap=this.radius*this.tree.overlapPct,this.radiusOverlap=this.radius+this.overlap,this.left=this.position.x-this.radiusOverlap,this.right=this.position.x+this.radiusOverlap,this.bottom=this.position.y-this.radiusOverlap,this.top=this.position.y+this.radiusOverlap,this.back=this.position.z-this.radiusOverlap,this.front=this.position.z+this.radiusOverlap,this.tree.scene&&(this.visual=new t.Mesh(this.tree.visualGeometry,this.tree.visualMaterial),this.visual.scale.set(2*this.radiusOverlap,2*this.radiusOverlap,2*this.radiusOverlap),this.visual.position.copy(this.position),this.tree.scene.add(this.visual))},t.OctreeNode.prototype={setParent:function(t){t!==this&&this.parent!==t&&(this.parent=t,this.updateProperties())},updateProperties:function(){var e,i;for(this.parent instanceof t.OctreeNode?(this.tree=this.parent.tree,this.depth=this.parent.depth+1):this.depth=0,e=0,i=this.nodesIndices.length;e<i;e++)this.nodesByIndex[this.nodesIndices[e]].updateProperties()},reset:function(t,e){var i,n,o,r=this.nodesIndices||[],s=this.nodesByIndex;for(this.objects=[],this.nodesIndices=[],this.nodesByIndex={},i=0,n=r.length;i<n;i++)o=s[r[i]],o.setParent(void 0),t===!0&&o.reset(t,e);e===!0&&this.visual&&this.visual.parent&&this.visual.parent.remove(this.visual)},addNode:function(t,e){t.indexOctant=e,o(this.nodesIndices,e)===-1&&this.nodesIndices.push(e),this.nodesByIndex[e]=t,t.parent!==this&&t.setParent(this)},removeNode:function(t){var e,i;e=o(this.nodesIndices,t),this.nodesIndices.splice(e,1),i=i||this.nodesByIndex[t],delete this.nodesByIndex[t],i.parent===this&&i.setParent(void 0)},addObject:function(e){var i,n,r;n=this.getOctantIndex(e),n>-1&&this.nodesIndices.length>0?(r=this.branch(n),r.addObject(e)):n<-1&&this.parent instanceof t.OctreeNode?this.parent.addObject(e):(i=o(this.objects,e),i===-1&&this.objects.push(e),e.node=this,this.checkGrow())},addObjectWithoutCheck:function(t){var e,i,n;for(e=0,i=t.length;e<i;e++)n=t[e],this.objects.push(n),n.node=this},removeObject:function(t){var e,i,n,o;if(o=this.removeObjectRecursive(t,{searchComplete:!1,nodesRemovedFrom:[],objectsDataRemoved:[]}),n=o.nodesRemovedFrom,n.length>0)for(e=0,i=n.length;e<i;e++)n[e].shrink();return o.objectsDataRemoved},removeObjectRecursive:function(e,i){var n,r,s,a,c,h=-1;if(e instanceof t.OctreeObjectData)h=o(this.objects,e),h!==-1&&(this.objects.splice(h,1),e.node=void 0,i.objectsDataRemoved.push(e),i.searchComplete=c=!0);else for(n=this.objects.length-1;n>=0;n--)if(s=this.objects[n],s.object===e&&(this.objects.splice(n,1),s.node=void 0,i.objectsDataRemoved.push(s),c=!0,!s.faces&&!s.vertices)){i.searchComplete=!0;break}if(c===!0&&i.nodesRemovedFrom.push(this),i.searchComplete!==!0)for(n=0,r=this.nodesIndices.length;n<r&&(a=this.nodesByIndex[this.nodesIndices[n]],i=a.removeObjectRecursive(e,i),i.searchComplete!==!0);n++);return i},checkGrow:function(){this.objects.length>this.tree.objectsThreshold&&this.tree.objectsThreshold>0&&this.grow()},grow:function(){var t,e,i,n,o=[],r=[],s=[],a=[],c=[];for(i=0,n=this.objects.length;i<n;i++)e=this.objects[i],t=this.getOctantIndex(e),t>-1?(s.push(e),a.push(t)):t<-1?(o.push(e),r.push(t)):c.push(e);s.length>0&&(c=c.concat(this.split(s,a))),o.length>0&&(c=c.concat(this.expand(o,r))),this.objects=c,this.checkMerge()},split:function(t,e){var i,n,o,r,s,a;if(this.depth<this.tree.depthMax){for(t=t||this.objects,e=e||[],a=[],i=0,n=t.length;i<n;i++)r=t[i],o=e[i],o>-1?(s=this.branch(o),s.addObject(r)):a.push(r);t===this.objects&&(this.objects=a)}else a=this.objects;return a},branch:function(e){var i,n,o,r,s,a;return this.nodesByIndex[e]instanceof t.OctreeNode?i=this.nodesByIndex[e]:(o=.5*this.radiusOverlap,n=o*this.tree.overlapPct,r=o-n,s=this.utilVec31Branch.set(1&e?r:-r,2&e?r:-r,4&e?r:-r),a=(new t.Vector3).addVectors(this.position,s),i=new t.OctreeNode({tree:this.tree,parent:this,position:a,radius:o,indexOctant:e}),this.addNode(i,e)),i},expand:function(e,i){var n,o,r,s,a,c,h,u,l,d,f,p,m,_,v,g,b,y,O,j,E,x,w,I,M,D,S,F,C,T=this.tree.INDEX_OUTSIDE_MAP,P=this.utilVec31Expand;if(this.tree.root.getDepthEnd()<this.tree.depthMax){for(e=e||this.objects,i=i||[],s=[],a=[],n=0,o=T.length;n<o;n++)T[n].count=0;for(n=0,o=e.length;n<o;n++)r=e[n],c=i[n],c<-1?(h=-c-this.tree.INDEX_OUTSIDE_OFFSET,h&this.tree.FLAG_POS_X?T[this.tree.INDEX_OUTSIDE_POS_X].count++:h&this.tree.FLAG_NEG_X&&T[this.tree.INDEX_OUTSIDE_NEG_X].count++,h&this.tree.FLAG_POS_Y?T[this.tree.INDEX_OUTSIDE_POS_Y].count++:h&this.tree.FLAG_NEG_Y&&T[this.tree.INDEX_OUTSIDE_NEG_Y].count++,h&this.tree.FLAG_POS_Z?T[this.tree.INDEX_OUTSIDE_POS_Z].count++:h&this.tree.FLAG_NEG_Z&&T[this.tree.INDEX_OUTSIDE_NEG_Z].count++,a.push(r)):s.push(r);if(a.length>0)for(l=T.slice(0),l.sort(function(t,e){return e.count-t.count}),d=l[0],m=1|d.index,v=l[1],g=l[2],f=(1|v.index)!==m?v:g,_=1|f.index,v=l[2],g=l[3],b=l[4],y=1|v.index,O=1|g.index,p=y!==m&&y!==_?v:O!==m&&O!==_?g:b,j=d.x+f.x+p.x,E=d.y+f.y+p.y,x=d.z+f.z+p.z,c=this.getOctantIndexFromPosition(j,E,x),u=this.getOctantIndexFromPosition(-j,-E,-x),w=this.overlap,I=this.radius,D=this.tree.overlapPct>0?w/(.5*this.tree.overlapPct*(1+this.tree.overlapPct)):2*I,S=D*this.tree.overlapPct,M=D+S-(I+w),P.set(1&c?M:-M,2&c?M:-M,4&c?M:-M),F=(new t.Vector3).addVectors(this.position,P),C=new t.OctreeNode({tree:this.tree,position:F,radius:D}),C.addNode(this,u),this.tree.setRoot(C),n=0,o=a.length;n<o;n++)this.tree.root.addObject(a[n]);e===this.objects&&(this.objects=s)}else s=e;return s},shrink:function(){this.checkMerge(),this.tree.root.checkContract()},checkMerge:function(){for(var e,i=this;i.parent instanceof t.OctreeNode&&i.getObjectCountEnd()<this.tree.objectsThreshold;)e=i,i=i.parent;i!==this&&i.merge(e)},merge:function(t){var e,i,o;for(t=n(t),e=0,i=t.length;e<i;e++)o=t[e],this.addObjectWithoutCheck(o.getObjectsEnd()),o.reset(!0,!0),this.removeNode(o.indexOctant,o);this.checkMerge()},checkContract:function(){var e,i,n,o,r,s,a;if(this.nodesIndices.length>0){for(s=0,a=this.objects.length,e=0,i=this.nodesIndices.length;e<i;e++)n=this.nodesByIndex[this.nodesIndices[e]],o=n.getObjectCountEnd(),a+=o,(r instanceof t.OctreeNode==!1||o>s)&&(r=n,s=o);a-=s,a<this.tree.objectsThreshold&&r instanceof t.OctreeNode&&this.contract(r)}},contract:function(t){var e,i,n;for(e=0,i=this.nodesIndices.length;e<i;e++)n=this.nodesByIndex[this.nodesIndices[e]],n!==t&&(t.addObjectWithoutCheck(n.getObjectsEnd()),n.reset(!0,!0));t.addObjectWithoutCheck(this.objects),this.reset(!1,!0),this.tree.setRoot(t),t.checkContract()},getOctantIndex:function(e){var i,n,o,r,s,a,c,h,u,l=this.position,d=this.radiusOverlap,f=this.overlap,p=0;if(e instanceof t.OctreeObjectData?(n=e.radius,i=e.position,e.positionLast.copy(i)):e instanceof t.OctreeNode&&(i=e.position,n=0),o=i.x-l.x,r=i.y-l.y,s=i.z-l.z,a=Math.abs(o),c=Math.abs(r),h=Math.abs(s),u=Math.max(a,c,h),u+n>d)return a+n>d&&(p^=o>0?this.tree.FLAG_POS_X:this.tree.FLAG_NEG_X),c+n>d&&(p^=r>0?this.tree.FLAG_POS_Y:this.tree.FLAG_NEG_Y),h+n>d&&(p^=s>0?this.tree.FLAG_POS_Z:this.tree.FLAG_NEG_Z),e.indexOctant=-p-this.tree.INDEX_OUTSIDE_OFFSET,e.indexOctant;if(o-n>-f)p|=1;else if(!(o+n<f))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;if(r-n>-f)p|=2;else if(!(r+n<f))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;if(s-n>-f)p|=4;else if(!(s+n<f))return e.indexOctant=this.tree.INDEX_INSIDE_CROSS,e.indexOctant;return e.indexOctant=p,e.indexOctant},getOctantIndexFromPosition:function(t,e,i){var n=0;return t>0&&(n|=1),e>0&&(n|=2),i>0&&(n|=4),n},search:function(t,e,i,n,o){var r,s,a,c;if(c=n?this.intersectRay(t,n,e,o):this.intersectSphere(t,e),c===!0)for(i=i.concat(this.objects),r=0,s=this.nodesIndices.length;r<s;r++)a=this.nodesByIndex[this.nodesIndices[r]],i=a.search(t,e,i,n);return i},intersectSphere:function(t,e){var i=e*e,n=t.x,o=t.y,r=t.z;return n<this.left?i-=Math.pow(n-this.left,2):n>this.right&&(i-=Math.pow(n-this.right,2)),o<this.bottom?i-=Math.pow(o-this.bottom,2):o>this.top&&(i-=Math.pow(o-this.top,2)),r<this.back?i-=Math.pow(r-this.back,2):r>this.front&&(i-=Math.pow(r-this.front,2)),i>=0},intersectRay:function(t,e,i,n){"undefined"==typeof n&&(n=this.utilVec31Ray.set(1,1,1).divide(e));var o,r=(this.left-t.x)*n.x,s=(this.right-t.x)*n.x,a=(this.bottom-t.y)*n.y,c=(this.top-t.y)*n.y,h=(this.back-t.z)*n.z,u=(this.front-t.z)*n.z,l=Math.min(Math.min(Math.max(r,s),Math.max(a,c)),Math.max(h,u));return!(l<0)&&(o=Math.max(Math.max(Math.min(r,s),Math.min(a,c)),Math.min(h,u)),!(o>l||o>i))},getDepthEnd:function(t){var e,i,n;if(this.nodesIndices.length>0)for(e=0,i=this.nodesIndices.length;e<i;e++)n=this.nodesByIndex[this.nodesIndices[e]],t=n.getDepthEnd(t);else t=!t||this.depth>t?this.depth:t;return t},getNodeCountEnd:function(){return this.tree.root.getNodeCountRecursive()+1},getNodeCountRecursive:function(){var t,e,i=this.nodesIndices.length;for(t=0,e=this.nodesIndices.length;t<e;t++)i+=this.nodesByIndex[this.nodesIndices[t]].getNodeCountRecursive();return i},getObjectsEnd:function(t){var e,i,n;for(t=(t||[]).concat(this.objects),e=0,i=this.nodesIndices.length;e<i;e++)n=this.nodesByIndex[this.nodesIndices[e]],t=n.getObjectsEnd(t);return t},getObjectCountEnd:function(){var t,e,i=this.objects.length;for(t=0,e=this.nodesIndices.length;t<e;t++)i+=this.nodesByIndex[this.nodesIndices[t]].getObjectCountEnd();return i},getObjectCountStart:function(){for(var e=this.objects.length,i=this.parent;i instanceof t.OctreeNode;)e+=i.objects.length,i=i.parent;return e},toConsole:function(t){var e,i,n,o="   ";for(t="string"==typeof t?t:o,console.log(this.parent?t+" octree NODE > ":" octree ROOT > ",this," // id: ",this.id," // indexOctant: ",this.indexOctant," // position: ",this.position.x,this.position.y,this.position.z," // radius: ",this.radius," // depth: ",this.depth),console.log(this.parent?t+" ":" ","+ objects ( ",this.objects.length," ) ",this.objects),console.log(this.parent?t+" ":" ","+ children ( ",this.nodesIndices.length," )",this.nodesIndices,this.nodesByIndex),e=0,i=this.nodesIndices.length;e<i;e++)n=this.nodesByIndex[this.nodesIndices[e]],n.toConsole(t+o)}},t.Raycaster.prototype.intersectOctreeObject=function(e,i){var n,o,r,s;if(e.object instanceof t.Object3D){o=e,e=o.object;var a="undefined"!=typeof e.geometry;s=o.faces,a&&(r=e.geometry.faces),s.length>0&&a&&(e.geometry.faces=s),n=this.intersectObject(e,i),s.length>0&&a&&(e.geometry.faces=r)}else n=this.intersectObject(e,i);return n},t.Raycaster.prototype.intersectOctreeObjects=function(t,e){var i,n,o=[];for(i=0,n=t.length;i<n;i++)o=o.concat(this.intersectOctreeObject(t[i],e));return o}}(n),t.exports=n},function(t,e,i){function n(){this._objects={}}var o=i(3);n.prototype={constructor:n,_objects:null,_getObjectId:function(t){return t.id+":"+t.uuid},update:function(){for(var t in this._objects){var e=this._objects[t];e&&"function"==typeof e.render&&e.render()}},add:function(t){var e=this._getObjectId(t);this.contains(e)||(this._objects[e]=t)},remove:function(t){var e=this._getObjectId(t);this.contains(e)&&delete this._objects[e]},contains:function(t){return t instanceof o.Object3D&&(t=this._getObjectId(t)),"undefined"!=typeof this._objects[t]}},t.exports=n},function(t,e,i){var n=i(3);n.OrbitControls=function(t,e){function i(){return 2*Math.PI/60/60*N.autoRotateSpeed}function o(){return Math.pow(.95,N.zoomSpeed)}function r(t){V.theta-=t}function s(t){V.phi-=t}function a(t){N.object instanceof n.PerspectiveCamera?R/=t:N.object instanceof n.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom*t)),N.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function c(t){N.object instanceof n.PerspectiveCamera?R*=t:N.object instanceof n.OrthographicCamera?(N.object.zoom=Math.max(N.minZoom,Math.min(N.maxZoom,N.object.zoom/t)),N.object.updateProjectionMatrix(),Y=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),N.enableZoom=!1)}function h(t){H.set(t.clientX,t.clientY)}function u(t){J.set(t.clientX,t.clientY)}function l(t){q.set(t.clientX,t.clientY)}function d(t){Z.set(t.clientX,t.clientY),W.subVectors(Z,H);var e=N.domElement===document?N.domElement.body:N.domElement;r(2*Math.PI*W.x/e.clientWidth*N.rotateSpeed),s(2*Math.PI*W.y/e.clientHeight*N.rotateSpeed),H.copy(Z),N.update()}function f(t){$.set(t.clientX,t.clientY),tt.subVectors($,J),tt.y>0?a(o()):tt.y<0&&c(o()),J.copy($),N.update()}function p(t){K.set(t.clientX,t.clientY),Q.subVectors(K,q),nt(Q.x,Q.y),q.copy(K),N.update()}function m(t){}function _(t){var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?c(o()):e<0&&a(o()),N.update()}function v(t){switch(t.keyCode){case N.keys.UP:nt(0,N.keyPanSpeed),N.update();break;case N.keys.BOTTOM:nt(0,-N.keyPanSpeed),N.update();break;case N.keys.LEFT:nt(N.keyPanSpeed,0),N.update();break;case N.keys.RIGHT:nt(-N.keyPanSpeed,0),N.update()}}function g(t){H.set(t.touches[0].pageX,t.touches[0].pageY)}function b(t){var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);J.set(0,n)}function y(t){q.set(t.touches[0].pageX,t.touches[0].pageY)}function O(t){Z.set(t.touches[0].pageX,t.touches[0].pageY),W.subVectors(Z,H);var e=N.domElement===document?N.domElement.body:N.domElement;r(2*Math.PI*W.x/e.clientWidth*N.rotateSpeed),s(2*Math.PI*W.y/e.clientHeight*N.rotateSpeed),H.copy(Z),N.update()}function j(t){var e=t.touches[0].pageX-t.touches[1].pageX,i=t.touches[0].pageY-t.touches[1].pageY,n=Math.sqrt(e*e+i*i);$.set(0,n),tt.subVectors($,J),tt.y>0?c(o()):tt.y<0&&a(o()),J.copy($),N.update()}function E(t){K.set(t.touches[0].pageX,t.touches[0].pageY),Q.subVectors(K,q),nt(Q.x,Q.y),q.copy(K),N.update()}function x(t){}function w(t){if(N.enabled!==!1){if(t.preventDefault(),t.button===N.mouseButtons.ORBIT){if(N.enableRotate===!1)return;h(t),U=k.ROTATE}else if(t.button===N.mouseButtons.ZOOM){if(N.enableZoom===!1)return;u(t),U=k.DOLLY}else if(t.button===N.mouseButtons.PAN){if(N.enablePan===!1)return;l(t),U=k.PAN}U!==k.NONE&&(document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",M,!1),document.addEventListener("mouseout",M,!1),N.dispatchEvent(A))}}function I(t){if(N.enabled!==!1)if(t.preventDefault(),U===k.ROTATE){if(N.enableRotate===!1)return;d(t)}else if(U===k.DOLLY){if(N.enableZoom===!1)return;f(t)}else if(U===k.PAN){if(N.enablePan===!1)return;p(t)}}function M(t){N.enabled!==!1&&(m(t),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",M,!1),document.removeEventListener("mouseout",M,!1),N.dispatchEvent(G),U=k.NONE)}function D(t){N.enabled===!1||N.enableZoom===!1||U!==k.NONE&&U!==k.ROTATE||(t.preventDefault(),t.stopPropagation(),_(t),N.dispatchEvent(A),N.dispatchEvent(G))}function S(t){N.enabled!==!1&&N.enableKeys!==!1&&N.enablePan!==!1&&v(t)}function F(t){if(N.enabled!==!1){switch(t.touches.length){case 1:if(N.enableRotate===!1)return;g(t),U=k.TOUCH_ROTATE;break;case 2:if(N.enableZoom===!1)return;b(t),U=k.TOUCH_DOLLY;break;case 3:if(N.enablePan===!1)return;y(t),U=k.TOUCH_PAN;break;default:U=k.NONE}U!==k.NONE&&N.dispatchEvent(A)}}function C(t){if(N.enabled!==!1)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(N.enableRotate===!1)return;if(U!==k.TOUCH_ROTATE)return;O(t);break;case 2:if(N.enableZoom===!1)return;if(U!==k.TOUCH_DOLLY)return;j(t);break;case 3:if(N.enablePan===!1)return;if(U!==k.TOUCH_PAN)return;E(t);break;default:U=k.NONE}}function T(t){N.enabled!==!1&&(x(t),N.dispatchEvent(G),U=k.NONE)}function P(t){t.preventDefault()}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.target=new n.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-(1/0),this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:n.MOUSE.LEFT,ZOOM:n.MOUSE.MIDDLE,PAN:n.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return z.phi},this.getAzimuthalAngle=function(){return z.theta},this.reset=function(){N.target.copy(N.target0),N.object.position.copy(N.position0),N.object.zoom=N.zoom0,N.object.updateProjectionMatrix(),N.dispatchEvent(L),N.update(),U=k.NONE},this.update=function(){var e=new n.Vector3,o=(new n.Quaternion).setFromUnitVectors(t.up,new n.Vector3(0,1,0)),s=o.clone().inverse(),a=new n.Vector3,c=new n.Quaternion;return function(){var t=N.object.position;return e.copy(t).sub(N.target),e.applyQuaternion(o),z.setFromVector3(e),N.autoRotate&&U===k.NONE&&r(i()),z.theta+=V.theta,z.phi+=V.phi,z.theta=Math.max(N.minAzimuthAngle,Math.min(N.maxAzimuthAngle,z.theta)),z.phi=Math.max(N.minPolarAngle,Math.min(N.maxPolarAngle,z.phi)),z.makeSafe(),z.radius*=R,z.radius=Math.max(N.minDistance,Math.min(N.maxDistance,z.radius)),N.target.add(B),e.setFromSpherical(z),e.applyQuaternion(s),t.copy(N.target).add(e),N.object.lookAt(N.target),N.enableDamping===!0?(V.theta*=1-N.dampingFactor,V.phi*=1-N.dampingFactor):V.set(0,0,0),R=1,B.set(0,0,0),!!(Y||a.distanceToSquared(N.object.position)>X||8*(1-c.dot(N.object.quaternion))>X)&&(N.dispatchEvent(L),a.copy(N.object.position),c.copy(N.object.quaternion),Y=!1,!0)}}(),this.dispose=function(){N.domElement.removeEventListener("contextmenu",P,!1),N.domElement.removeEventListener("mousedown",w,!1),N.domElement.removeEventListener("mousewheel",D,!1),N.domElement.removeEventListener("MozMousePixelScroll",D,!1),N.domElement.removeEventListener("touchstart",F,!1),N.domElement.removeEventListener("touchend",T,!1),N.domElement.removeEventListener("touchmove",C,!1),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",M,!1),document.removeEventListener("mouseout",M,!1),window.removeEventListener("keydown",S,!1)};var N=this,L={type:"change"},A={type:"start"},G={type:"end"},k={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},U=k.NONE,X=1e-6,z=new n.Spherical,V=new n.Spherical,R=1,B=new n.Vector3,Y=!1,H=new n.Vector2,Z=new n.Vector2,W=new n.Vector2,q=new n.Vector2,K=new n.Vector2,Q=new n.Vector2,J=new n.Vector2,$=new n.Vector2,tt=new n.Vector2,et=function(){var t=new n.Vector3;return function(e,i){t.setFromMatrixColumn(i,0),t.multiplyScalar(-e),B.add(t)}}(),it=function(){var t=new n.Vector3;return function(e,i){t.setFromMatrixColumn(i,1),t.multiplyScalar(e),B.add(t)}}(),nt=function(){var t=new n.Vector3;return function(e,i){var o=N.domElement===document?N.domElement.body:N.domElement;if(N.object instanceof n.PerspectiveCamera){var r=N.object.position;t.copy(r).sub(N.target);var s=t.length();s*=Math.tan(N.object.fov/2*Math.PI/180),et(2*e*s/o.clientHeight,N.object.matrix),it(2*i*s/o.clientHeight,N.object.matrix)}else N.object instanceof n.OrthographicCamera?(et(e*(N.object.right-N.object.left)/N.object.zoom/o.clientWidth,N.object.matrix),it(i*(N.object.top-N.object.bottom)/N.object.zoom/o.clientHeight,N.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),N.enablePan=!1)}}();N.domElement.addEventListener("contextmenu",P,!1),N.domElement.addEventListener("mousedown",w,!1),N.domElement.addEventListener("mousewheel",D,!1),N.domElement.addEventListener("MozMousePixelScroll",D,!1),N.domElement.addEventListener("touchstart",F,!1),N.domElement.addEventListener("touchend",T,!1),N.domElement.addEventListener("touchmove",C,!1),window.addEventListener("keydown",S,!1),this.update()},n.OrbitControls.prototype=Object.create(n.EventDispatcher.prototype),n.OrbitControls.prototype.constructor=n.OrbitControls,Object.defineProperties(n.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}})},function(t,e,i){var n=i(3),o=i(7),r=i(4),s=i(5),a=i(9),c=i(11),h=i(19),u=i(20),l=i(21);i(22);var d=function(t,e){n.Mesh.call(this,t,e)};d.prototype=r(n.Mesh.prototype,s.prototype,a.prototype,{constructor:d,mouseOut:function(t){},mouseOver:function(t){},click:function(t){}});var f=function(){n.Group.call(this);var t=this;this._crusts=new d,this._crusts.interactive=!0,this._crusts.useFaces=!0,this._crusts._focusGroupObject=void 0,this._crusts.mouseOut=function(e){this._focusGroupObject&&(this._focusGroupObject.mouseOut(),this._focusGroupObject=null),t.dispatchEvent({type:"itemMouseOut",mouseEvent:e,index:-1,feature:null,data:null})},this._crusts.mouseOver=function(e){var i=this.geometry.attributes.groupIndex.getX(e.index),n=t._groupData[i];if(this._focusGroupObject!=n){this._focusGroupObject&&this._focusGroupObject.mouseOut(),this._focusGroupObject=n,this._focusGroupObject&&this._focusGroupObject.mouseOver();var o=t.mapData.features[i];t.dispatchEvent({type:"itemMouseOver",mouseEvent:e,index:i,feature:o,data:n.item})}},this._crusts.click=function(e){var i=this.geometry.attributes.groupIndex.getX(e.index),n=t._groupData[i],o=t.mapData.features[i];t.dispatchEvent({type:"itemClick",mouseEvent:e,index:i,feature:o,data:n.item})},this._strokes=new n.LineSegments};f.prototype=r(n.Group.prototype,s.prototype,c.prototype,{constructor:f,_crusts:void 0,_strokes:void 0,_labels:void 0,_featureIdMap:void 0,_groupIdMap:void 0,_groupData:void 0,_selectedIndex:null,get selectedIndex(){return this._selectedIndex},set selectedIndex(t){this._groupData[this._selectedIndex]&&(this._groupData[this._selectedIndex].selected=!1),this._selectedIndex=t,this._groupData[this._selectedIndex]&&(this._groupData[this._selectedIndex].selected=!0)},_scaleX:1,get scaleX(){return this._scaleX},set scaleX(t){this._scaleX=t,this._invalidateXY()},_scaleY:1,get scaleY(){return this._scaleY},set scaleY(t){this._scaleY=t,this._invalidateXY()},_scaleZ:1,get scaleZ(){return this._scaleZ},set scaleZ(t){this._scaleZ=t,this._invalidateZ()},_mapData:null,get mapData(){return this._mapData},set mapData(t){this._mapData=t,this._calculateBoundingBox(),this._invalidateGeometry()},_itemData:null,get itemData(){return this._itemData},set itemData(t){this._itemData=t,this._invalidateItemData()},_idField:"id",get idField(){return this._idField},set idField(t){this._idField=t},_fillColor:16777215,get fillColor(){return this._fillColor},set fillColor(t){this._fillColor=t},_strokeColor:0,get strokeColor(){return this._strokeColor},set strokeColor(t){this._strokeColor=t},_labelFillColor:16777215,get labelFillColor(){return this._labelFillColor},set labelFillColor(t){this._labelFillColor=t},_labelStrokeColor:0,get labelStrokeColor(){return this._labelStrokeColor},set labelStrokeColor(t){this._labelStrokeColor=t},_highlightColor:16711680,get highlightColor(){return this._highlightColor},set highlightColor(t){this._highlightColor=t},_highlightOffset:0,get highlightOffset(){return this._highlightOffset},set highlightOffset(t){this._highlightOffset=t},_highlightAnimationDuration:50,get highlightAnimationDuration(){return this._highlightAnimationDuration},set highlightAnimationDuration(t){this._highlightAnimationDuration=Math.max(t,50)},_boundingBox:null,get boundingBox(){return this._boundingBox},_invalidateGeometryFlag:!1,_invalidateGeometry:function(){this._invalidateGeometryFlag||(this._invalidateGeometryFlag=!0,this.invalidateProperties())},_invalidateXYFlag:!1,_invalidateXY:function(){this._invalidateXYFlag||(this._invalidateXYFlag=!0,this.invalidateProperties())},_invalidateZFlag:!1,_invalidateZ:function(){this._invalidateZFlag||(this._invalidateZFlag=!0,this.invalidateProperties())},_invalidateItemDataFlag:!1,_invalidateItemData:function(){this._invalidateItemDataFlag||(this._invalidateItemDataFlag=!0,this.invalidateProperties())},_calculateBoundingBox:function(t,e){var i=this;if(0==arguments.length)this._boundingBox=new u,this._featureIdMap={},this._mapData.features.forEach(function(t){var e=t.properties[i._idField];i._featureIdMap[e]=t;var n=t.geometry;t.boundingBox=new u,"MultiPolygon"==n.type?n.coordinates.forEach(function(e){i._calculateBoundingBox(e,t.boundingBox)}):"Polygon"==n.type?i._calculateBoundingBox(n.coordinates,t.boundingBox):console.warn("Unsupported geometry:",n),i._enrichBoundingBox(t.boundingBox)}),this._enrichBoundingBox(this._boundingBox);else if(t instanceof Array)for(var n=t[0],o=0;o<n.length;o++){var r=n[o],s=r[0],a=r[1];this._boundingBox.expand(s,a),e.expand(s,a)}},_enrichBoundingBox:function(t){t.x=t.minX,t.y=t.minY,t.width=t.maxX-t.minX,t.height=t.maxY-t.minY,t.centerX=(t.minX+t.maxX)/2,t.centerY=(t.minY+t.maxY)/2},_createShape:function(t){var e=t[0];e=e.concat([e[1]]);for(var i=[],n=0;n<e.length;n++){var o=e[n],r=o[0];r-=this._boundingBox.centerX,r*=this._scaleX,r=r.toFixed(4);var s=o[1];s-=this._boundingBox.centerY,s*=this._scaleY,s=s.toFixed(4),i.push(0==n?"M":"L",r,s),n==e.length-1&&i.push("Z")}var a=i.join(" ");return l.transformSVGPath(a)},_createCrustGeometry:function(t,e){var i=new n.ExtrudeGeometry(t,{amount:this._scaleZ,bevelEnabled:!1}),o=e.properties.zOffset;isNaN(o)&&(o=1);for(var r=0,s=i.vertices.length;r<s;r++)i.vertices[r].z*=o;return i},_createStrokeGeometry:function(t,e){var i=new n.ShapeGeometry(t),o=e.properties.zOffset;isNaN(o)&&(o=1);for(var r=0,s=i.vertices.length;r<s;r++)i.vertices[r].z+=this._scaleZ*o;return i},_mergeStrokeGeometry:function(t,e,i){var n=e._vertices;n||(n=e._vertices=[]);var o=e._indices;o||(o=e._indices=[]);var r=e._groupIndices;r||(r=e._groupIndices=[]);for(var s=0,a=t.vertices.length,c=n.length;s<a;s++,c++)n.push(t.vertices[s]),r.push(i),s<a-1&&o.push(c,c+1);return e},_updateGroupData:function(){var t=this,e=this._mapData.features.length,i=[10940370,7921084,3261854,6278319,2403983],r=i.map(function(t){return new n.Color(t)}),s=[],a=[];this._groupData={length:this._mapData.features.length,colorMap:s,offsetMap:a},this._groupIdMap={};for(var c=0,h=0;c<e;c++,h+=3){var u=r[c%r.length];u=new n.Color(this._fillColor),s[h]=u.r,s[h+1]=u.g,s[h+2]=u.b,a[h]=0,a[h+1]=0,a[h+2]=0;var l=this._mapData.features[c],d={index:c,color:u,item:null,_tweenObject:{
    colorT:0,offsetT:0},_tweenColor:void 0,_tweenOffset:void 0,_selected:!1,get selected(){return this._selected},set selected(t){this._selected=t,this._selected?this.mouseOver():this.mouseOut()},mouseOut:function(){if(!this._selected){var e=t._highlightAnimationDuration;this._tweenColor&&this._tweenColor.stop();var i=3*this.index,r=this.color,s=new n.Color(t._highlightColor),a=this;this._tweenColor=new o.Tween(this._tweenObject).to({colorT:0},e).onUpdate(function(){a._renderColor(i,this.colorT,r,s)}).start(),this._tweenOffset&&this._tweenOffset.stop(),this._tweenOffset=new o.Tween(this._tweenObject).to({offsetT:0},e).onUpdate(function(){a._renderOffset(i,this.offsetT)}).start()}},mouseOver:function(){var e=this,i=t._highlightAnimationDuration;this._tweenColor&&this._tweenColor.stop();var r=3*this.index,s=this.color,a=new n.Color(t._highlightColor);this._tweenColor=new o.Tween(this._tweenObject).to({colorT:1},i).onUpdate(function(){e._renderColor(r,this.colorT,s,a)}).start(),this._tweenOffset&&this._tweenOffset.stop(),this._tweenOffset=new o.Tween(this._tweenObject).to({offsetT:1},i).onUpdate(function(){e._renderOffset(r,this.offsetT)}).start()},colorTo:function(t){var e=this;this._tweenColor&&this._tweenColor.stop();var i=3*this.index,n=this.color,r=this.color=t;this._tweenColor=new o.Tween({t:0}).to({t:1},500).onUpdate(function(){e._renderColor(i,this.t,n,r)}).start()},_renderColor:function(t,e,i,n){s[t]=i.r+(n.r-i.r)*e,s[t+1]=i.g+(n.g-i.g)*e,s[t+2]=i.b+(n.b-i.b)*e},_renderOffset:function(e,i){a[e]=0,a[e+1]=0,a[e+2]=i*t._highlightOffset}};this._groupData[d.index]=d;var f=l.properties[this._idField];this._groupIdMap[f]=d}},_updateCrusts:function(t){var e=this._groupData.length,o=(new n.BufferGeometry).fromGeometry(t);o.removeAttribute("color");var r=[];o.groups.forEach(function(t){for(var e=t.start,i=t.start+t.count;e<i;e++)r.push(t.materialIndex)}),o.addAttribute("groupIndex",new n.Float32Attribute(r.length,1).copyArray(r));var s=new n.ShaderMaterial({uniforms:n.UniformsUtils.merge([n.ShaderLib.phong.uniforms],{colorMap:{type:"fv",value:this._groupData.colorMap},offsetMap:{type:"fv",value:this._groupData.offsetMap}}),vertexShader:["#define NUM_GROUPS "+e,i(23)].join("\n"),fragmentShader:i(24),lights:!0});this._crusts.geometry=o,this._crusts.material=s,this.addObject(this._crusts)},_updateStrokes:function(t){var e=this._groupData.length,o=t,r=o._vertices,s=o._indices,a=o._groupIndices;o.addAttribute("position",new n.Float32Attribute(3*r.length,3).copyVector3sArray(r)),o.setIndex(new(s.length>65535?n.Uint32Attribute:n.Uint16Attribute)(s.length,1).copyArray(s)),o.addAttribute("groupIndex",new n.Float32Attribute(a.length,1).copyArray(a)),delete o._vertices,delete o._indices,delete o._groupIndices;var c=new n.ShaderMaterial({uniforms:{offsetMap:{type:"fv",value:this._groupData.offsetMap},opacity:{type:"f",value:1},diffuse:{type:"c",value:new n.Color(this._strokeColor)}},vertexShader:["#define NUM_GROUPS "+e,i(25)].join("\n"),fragmentShader:i(26),depthWrite:!1,side:n.DoubleSide});this._strokes.geometry=o,this._strokes.material=c,this._strokes.position.z=.01*this._scaleZ,this.addObject(this._strokes)},_updateLabels:function(){var t=this;if(this._labels&&this._labels.length>0&&(this._labels.forEach(function(e){t.removeObject(e)}),this._labels=null),this._groupData)for(var e="#"+new n.Color(this._labelFillColor).getHexString(),i="#"+new n.Color(this._labelStrokeColor).getHexString(),o=0,r=this._groupData.length;o<r;o++){var s=this._groupData[o],a=this._mapData.features[s.index],c=a.properties.zOffset;isNaN(c)&&(c=1);var u=new n.PlaneBufferGeometry(.1*this._scaleX,.1*this._scaleY,10,10),l=new n.MeshBasicMaterial({map:h.createTextureWithText(a.properties.name,{fillStyle:e,strokeStyle:i}),depthWrite:!1,transparent:!0}),d=new n.Mesh(u,l),f=a.boundingBox.centerX,p=a.boundingBox.centerY;d.position.x=(f-this._boundingBox.centerX)*this._scaleX,d.position.y=(p-this._boundingBox.centerY)*this._scaleY,d.position.z=t.scaleZ*(c+.05),this.addObject(d)}},commitProperties:function(){var t=this;if(this._invalidateGeometryFlag){this.removeObject(this._crusts),this.removeObject(this._diagonals),this.removeObject(this._strokes),this.removeObject(this._southSea);var e=new n.Geometry,i=new n.BufferGeometry;this._mapData.features.forEach(function(n,o){var r=n.geometry;if("MultiPolygon"==r.type)r.coordinates.forEach(function(r){var s=t._createShape(r),a=t._createCrustGeometry(s,n);e.merge2(a,void 0,o);var c=t._createStrokeGeometry(s,n);t._mergeStrokeGeometry(c,i,o)});else if("Polygon"==r.type){var s=t._createShape(r.coordinates),a=t._createCrustGeometry(s,n);e.merge2(a,void 0,o);var c=t._createStrokeGeometry(s,n);t._mergeStrokeGeometry(c,i,o)}else console.warn("Unsupported geometry:",r)}),this._updateGroupData(),this._updateCrusts(e),this._updateStrokes(i),this._updateLabels(),this._invalidateGeometryFlag=!1}this._invalidateItemDataFlag&&(this._itemData&&this._itemData.forEach(function(e){var i=t._groupIdMap[e.id];i&&(i.item=e,e.color&&i.colorTo(new n.Color(e.color)))}),this._invalidateItemDataFlag=!1)},lonLatToXY:function(t,e){return new n.Vector2((t-this._boundingBox.centerX)*this._scaleX,(e-this._boundingBox.centerY)*this._scaleY)},getFeature:function(t){return this._featureIdMap[t]}}),t.exports=f},function(t,e,i){function n(t){o||(o=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"));var e=o.getContext("2d");t&&e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,o.width,o.height),t&&e.restore(),o.width=256,o.height=256}var o,r=i(3),s=4096,a={get canvas(){return n(),o},createTextureWithText:function(t,e){e=e||{},n();var i=e.adaptable===!0;if(i){var s=e.direction||0;g=e.fontSize||256;var a=g;this.isPowerOfTwo(a)||(a=this.getBestPowerOf2(a));var c=e.maxSize||g*t.length;this.isPowerOfTwo(c)||(c=this.getBestPowerOf2(c)),o.width=s?a:c,o.height=s?c:a,v=o.getContext("2d"),v.font="normal normal bolder "+g+"px 黑体",v.textBaseline="middle",v.fillStyle=e.fillStyle||"#FFFFFF",v.strokeStyle=e.strokeStyle||"#000000";for(var h=0,u=s?Math.round((o.width-g)/2):0,l=s?0:Math.round((o.height-g)/2),d=g/2,f=0,p=t.length;f<p;f++){var m=g*f,_=t.charAt(f);b=(s?h:m)+u,y=(s?m:h)+l+d,v.fillText(_,b,y),v.strokeText(_,b,y)}}else{var v=o.getContext("2d"),g=Math.floor(Math.min(o.width,o.height)/t.length);v.font="normal normal bolder "+g+"px 黑体",v.textBaseline="middle";var b=(o.width-t.length*g)/2,y=o.height/2;v.fillStyle=e.fillStyle||"#FFFFFF",v.fillText(t,b,y),v.strokeStyle=e.strokeStyle||"#000000",v.strokeText(t,b,y)}var O=new Image;O.src=o.toDataURL(),O._width=o.width,O._height=o.height;var j=new r.Texture(O);return j.needsUpdate=!0,j},createTextureWithSolidColor:function(t){n();var e=o.getContext("2d");e.fillStyle=t||"#FFFFFF",e.fillRect(0,0,o.width,o.height);var i=new Image;i.src=o.toDataURL();var s=new r.Texture(i);return s.needsUpdate=!0,s},createTextureWithSvg:function(t){n();var e=o.getContext("2d");e.fillStyle=color||"#FFFFFF",e.fillRect(0,0,o.width,o.height);var i=new Image;i.src=o.toDataURL();var s=new r.Texture(i);return s.needsUpdate=!0,s},calculateVisiblePoints:function(t){},isPowerOfTwo:function(t){return!!t&&(t&-t)==t},getBestPowerOf2:function(t){for(var e=1;e<t;)e<<=1;return e>s&&(e=s),e},mergeTexture:function(t,e){n();var i=[];i.forEach(function(t,e){})}};Object.seal(a),t.exports=a},function(t,e){function i(){this.minX=Number.MAX_VALUE,this.minY=Number.MAX_VALUE,this.maxX=Number.MIN_VALUE,this.maxY=Number.MIN_VALUE}i.prototype={constructor:i,minX:Number.MAX_VALUE,minY:Number.MAX_VALUE,maxX:Number.MIN_VALUE,maxY:Number.MIN_VALUE,expand:function(t,e){this.minX>t&&(this.minX=t),this.minY>e&&(this.minY=e),this.maxX<t&&(this.maxX=t),this.maxY<e&&(this.maxY=e)},contains:function(t,e){return t>=this.minX&&t<=this.maxX&&e>=this.minY&&e<=this.maxY}},t.exports=i},function(t,e,i){function n(t){const e=Math.PI/180,i=48,n=57,r=44,s=32,a=46,c=45;t.transformSVGPath=function(t){function h(){for(var e,o,h,u=!1;_<v&&(o=t.charCodeAt(_),o===r||o===s);)_++;for(e=o===c?_++:_;_<v;)if(o=t.charCodeAt(_),i<=o&&o<=n)_++;else{if(o!==a)return h=t.substring(e,_),u?parseFloat(h):parseInt(h);_++,u=!0}return h=t.substring(e),u?parseFloat(h):parseInt(h)}function u(){for(var e;_<v&&(e=t.charCodeAt(_),e===r||e===s);)_++;return e=t.charCodeAt(_),e===c||i<=e&&e<=n}var l,d,f,p,m=new o.Shape,_=1,v=t.length,g=0,b=0,y=0,O=0,j=null,E=null,x=0,w=0,I=0,M=0,D=0,S=0,F=0,C=0,T=0;for(l=t[0];_<=v;){switch(p=!0,l){case"M":g=h(),b=h(),m.moveTo(g,b),l="L",j=g,E=b;break;case"m":g+=h(),b+=h(),m.moveTo(g,b),l="l",j=g,E=b;break;case"Z":case"z":p=!1,g===j&&b===E||m.lineTo(j,E);break;case"L":case"H":case"V":y="V"===l?g:h(),O="H"===l?b:h(),m.lineTo(y,O),g=y,b=O;break;case"l":case"h":case"v":y="v"===l?g:g+h(),O="h"===l?b:b+h(),m.lineTo(y,O),g=y,b=O;break;case"C":x=h(),I=h();case"S":"S"===l&&(x=2*g-w,I=2*b-M),w=h(),M=h(),y=h(),O=h(),m.bezierCurveTo(x,I,w,M,y,O),g=y,b=O;break;case"c":x=g+h(),I=b+h();case"s":"s"===l&&(x=2*g-w,I=2*b-M),w=g+h(),M=b+h(),y=g+h(),O=b+h(),m.bezierCurveTo(x,I,w,M,y,O),g=y,b=O;break;case"Q":x=h(),I=h();case"T":"T"===l&&(x=2*g-x,I=2*b-I),y=h(),O=h(),m.quadraticCurveTo(x,I,y,O),g=y,b=O;break;case"q":x=g+h(),I=b+h();case"t":"t"===l&&(x=2*g-x,I=2*b-I),y=g+h(),O=b+h(),m.quadraticCurveTo(x,I,y,O),g=y,b=O;break;case"A":D=h(),S=h(),F=h()*e,C=h(),T=h(),y=h(),O=h(),D!==S&&console.warn("Forcing elliptical arc to be a circular one :(",D,S),x=Math.cos(F)*(g-y)/2+Math.sin(F)*(b-O)/2,I=-Math.sin(F)*(g-y)/2+Math.cos(F)*(b-O)/2;var P=Math.sqrt((D*D*S*S-D*D*I*I-S*S*x*x)/(D*D*I*I+S*S*x*x));C===T&&(P=-P),w=P*D*I/S,M=P*-S*x/D,d=Math.cos(F)*w-Math.sin(F)*M+(g+y)/2,f=Math.sin(F)*w+Math.cos(F)*M+(b+O)/2;var N=new o.Vector2(1,0),L=new o.Vector2((x-w)/D,(I-M)/S),A=Math.acos(N.dot(L)/N.length()/L.length());N.x*L.y-N.y*L.x<0&&(A=-A),N.x=(-x-w)/D,N.y=(-I-M)/S;var G=Math.acos(L.dot(N)/L.length()/N.length());L.x*N.y-L.y*N.x<0&&(G=-G),!T&&G>0&&(G-=2*Math.PI),T&&G<0&&(G+=2*Math.PI),m.absarc(d,f,D,A,A+G,T),g=y,b=O;break;default:throw new Error("weird path command: "+l)}p&&u()||(l=t[_++])}return m}}var o=i(3),r={};n(r),t.exports=r},function(t,e,i){var n=i(3);n.Geometry.prototype.merge2=function(t,e,i){if((t&&t.isGeometry)===!1)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var o,r=this.vertices.length,s=this.vertices,a=t.vertices,c=this.faces,h=t.faces,u=this.faceVertexUvs[0],l=t.faceVertexUvs[0];void 0===i&&(i=0),void 0!==e&&(o=(new Matrix3).getNormalMatrix(e));for(var d=0,f=a.length;d<f;d++){var p=a[d],m=p.clone();void 0!==e&&m.applyMatrix4(e),s.push(m)}for(d=0,f=h.length;d<f;d++){var _,v,g,b=h[d],y=b.vertexNormals,O=b.vertexColors;_=new n.Face3(b.a+r,b.b+r,b.c+r),_.normal.copy(b.normal),void 0!==o&&_.normal.applyMatrix3(o).normalize();for(var j=0,E=y.length;j<E;j++)v=y[j].clone(),void 0!==o&&v.applyMatrix3(o).normalize(),_.vertexNormals.push(v);_.color.copy(b.color);for(var j=0,E=O.length;j<E;j++)g=O[j],_.vertexColors.push(g.clone());_.materialIndex=i,c.push(_)}for(d=0,f=l.length;d<f;d++){var x=l[d],w=[];if(void 0!==x){for(var j=0,E=x.length;j<E;j++)w.push(x[j].clone());u.push(w)}}},n.UniformsUtils.merge=function(t,e){for(var i={},n=0;n<t.length;n++){var o=this.clone(t[n]);for(var r in o)i[r]=o[r]}if("object"==typeof e&&null!=e)for(r in e)e.hasOwnProperty(r)&&(i[r]=e[r]);return i}},function(t,e){t.exports="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n//<!--\n#ifdef NUM_GROUPS\nuniform vec3 offsetMap[NUM_GROUPS];\nuniform vec3 colorMap[NUM_GROUPS];\n#endif\nattribute float groupIndex;\nvarying vec3 diffuse;\n//-->\nvoid main() {\n    #include <uv_vertex>\n    #include <uv2_vertex>\n    #include <color_vertex>\n    #include <beginnormal_vertex>\n    #include <morphnormal_vertex>\n    #include <skinbase_vertex>\n    #include <skinnormal_vertex>\n    #include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n    vNormal = normalize( transformedNormal );\n#endif\n    #include <begin_vertex>\n    //<!--\n    #ifdef NUM_GROUPS\n    int mapIndex = int(groupIndex);\n    vec3 offset = offsetMap[mapIndex];\n    transformed += offset;\n    vec3 color = colorMap[mapIndex];\n    diffuse = color;\n    #endif\n    //-->\n    #include <displacementmap_vertex>\n    #include <morphtarget_vertex>\n    #include <skinning_vertex>\n    #include <project_vertex>\n    #include <logdepthbuf_vertex>\n    #include <clipping_planes_vertex>\n    vViewPosition = - mvPosition.xyz;\n    #include <worldpos_vertex>\n    #include <envmap_vertex>\n    #include <shadowmap_vertex>\n}"},function(t,e){t.exports="#define PHONG\n//<!--\nvarying vec3 diffuse;\n//-->\n//uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n    #include <clipping_planes_fragment>\n    vec4 diffuseColor = vec4( diffuse, opacity );\n    ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n    vec3 totalEmissiveRadiance = emissive;\n    #include <logdepthbuf_fragment>\n    #include <map_fragment>\n    #include <color_fragment>\n    #include <alphamap_fragment>\n    #include <alphatest_fragment>\n    #include <specularmap_fragment>\n    #include <normal_flip>\n    #include <normal_fragment>\n    #include <emissivemap_fragment>\n    #include <lights_phong_fragment>\n    #include <lights_template>\n    #include <aomap_fragment>\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n    #include <envmap_fragment>\n    gl_FragColor = vec4( outgoingLight, diffuseColor.a );\n    #include <premultiplied_alpha_fragment>\n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n}"},function(t,e){t.exports="//<!--\n#ifdef NUM_GROUPS\nuniform vec3 offsetMap[NUM_GROUPS];\n#endif\nattribute float groupIndex;\n//-->\nvoid main() {\n    vec3 mvPosition = position;\n    #ifdef NUM_GROUPS\n    int mapIndex = int(groupIndex);\n    vec3 offset = offsetMap[mapIndex];\n    mvPosition += offset;\n    #endif\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(mvPosition, 1.0);\n}"},function(t,e){t.exports="uniform vec3 diffuse;\nuniform float opacity;\nvoid main() {\n    gl_FragColor = vec4(diffuse, opacity);\n}"},function(t,e,i){function n(){o.Mesh.call(this),this.rotation.y=45*Math.PI/180,this.interactive=!0,this.t=0}var o=i(3),r=i(11),s=i(5),a=i(4),c=i(7),h=["uniform float time;","uniform bool flag;","uniform vec3 color;","uniform float alpha;","uniform float a0;","uniform float a1;","attribute float alphaOffset;","varying vec3 vColor;","varying float vAlpha;","void main() {","    vColor = color;","    float coef = (1.0 + sin(time / 2.0 + alphaOffset)) / 2.0;","    if (flag)","        vAlpha = (a0 + (a1 - a0) * coef) * alpha;","    else vAlpha = a1 * alpha;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),u=["varying vec3 vColor;","varying float vAlpha;","void main() {","    gl_FragColor = vec4(vColor, vAlpha);","}"].join("\n");n.prototype=a(o.Mesh.prototype,r.prototype,s.prototype,{constructor:n,_indices1:null,_indices2:null,dispatcher:void 0,item:void 0,_invalidateSizeFlag:!1,_invalidateSize:function(){this._invalidateSizeFlag||(this._invalidateSizeFlag=!0,this.invalidateProperties())},_invalidateGeometryFlag:!1,_invalidateGeometry:function(){this._invalidateGeometryFlag||(this._invalidateGeometryFlag=!0,this.invalidateProperties())},_radiusTop:1,get radiusTop(){return this._radiusTop},set radiusTop(t){this._radiusTop=t,this._invalidateGeometry()},_radiusBottom:1,get radiusBottom(){return this._radiusBottom},set radiusBottom(t){this._radiusBottom=t,this._invalidateGeometry()},_height:1,get height(){return this._height},set height(t){this._height=t,this._startHeight=0,this._endHeight=this._height,this._invalidateSize()},_startHeight:0,get startHeight(){return this._startHeight},set startHeight(t){this._startHeight=t,this._invalidateSize()},_endHeight:1,get endHeight(){return this._endHeight},set endHeight(t){this._endHeight=t,this._invalidateSize()},_numSides:1,get numSides(){return this._numSides},set numSides(t){this._numSides=Math.max(t,3),this._invalidateGeometry()},_color:11806719,get color(){return this._color},set color(t){this._color=t,0==this._style?this.material.color=new o.Color(this._color):1==this._style&&(this.material.uniforms.color.value=new o.Color(this._color))},_emphasisColor:16711680,get emphasisColor(){return this._emphasisColor},set emphasisColor(t){this._emphasisColor=t},_style:0,get style(){return this._style},set style(t){this._style=t,0==this._style?this.material=new o.MeshPhongMaterial({color:new o.Color(this._color),emissive:2105376}):1==this._style&&(this.material=new o.ShaderMaterial({uniforms:{time:{type:"f",value:0},color:{type:"c",value:new o.Color(this._color)},alpha:{type:"f",value:1},a0:{type:"f",value:.78},a1:{type:"f",value:1},flag:{type:"b",value:!0}},vertexShader:h,fragmentShader:u,depthTest:!0,transparent:!1}))},get width(){return 0},_time:0,render:function(){this._time+=.025,1==this._style&&(this.material.uniforms.time.value=2*this._time*Math.PI)},commitProperties:function(){var t=this;if(this._invalidateGeometryFlag){this.geometry=new o.CylinderBufferGeometry(this._radiusTop,this._radiusBottom,100,this._numSides,1),this._invalidateGeometryFlag=!1,this._invalidateSizeFlag=!0,this._effectObject(this),this._indices1=[],this._indices2=[];for(var e=this.geometry.attributes.position.array,i=e.length/3,n=0,r=0;r<i;r++)e[n+1]<0?this._indices1.push(r):this._indices2.push(r),n+=3}if(this._invalidateSizeFlag){var e=this.geometry.attributes.position.array;this._indices1.forEach(function(i){e[3*i+1]=t._startHeight}),this._indices2.forEach(function(i){e[3*i+1]=t._endHeight}),this.geometry.attributes.position.needsUpdate=!0,this.geometry.computeBoundingBox(),this.geometry.computeBoundingSphere(),this._invalidateSizeFlag=!1}},_effectObject:function(t){!(t.geometry instanceof o.BufferGeometry)&&t.geometry instanceof o.Geometry&&(t.geometry=(new o.BufferGeometry).fromGeometry(t.geometry));for(var e=t.geometry.attributes.position.length/3,i=[],n=0;n<e;n++)i.push(Math.random()*Math.PI*2);t.geometry.addAttribute("alphaOffset",new o.Float32Attribute(i,1))},_updateMaterial:function(t){0==this._style?this.material.color=new o.Color(t):1==this._style&&(this.material.uniforms.color.value=new o.Color(t))},appear:function(t,e){this.startHeight=0,this.endHeight=0,new c.Tween(this).to({endHeight:this._height},e||1e3).delay(t||0).start()},disappear:function(t,e,i){var n=this;this.t=1,new c.Tween(this).to({t:0},e||1e3).delay(t||0).onUpdate(function(){this.scale.set(this.t,this.t,this.t)}).onComplete(function(){"function"==typeof i&&i.call(n)}).start()},mouseOut:function(t){this._updateMaterial(this._color);var e=this.dispatcher||this;e.dispatchEvent({type:"columnItemMouseOut",mouseEvent:t})},mouseOver:function(t){this._updateMaterial(this._emphasisColor);var e=this.dispatcher||this;e.dispatchEvent({type:"columnItemMouseOver",mouseEvent:t,item:this.item})},click:function(t){var e=this.dispatcher||this;e.dispatchEvent({type:"columnItemClick",mouseEvent:t,item:this.item})}}),t.exports=n},function(t,e){t.exports={type:"FeatureCollection",features:[{type:"Feature",properties:{name:"嘉祥县",id:"370829"},geometry:{type:"MultiPolygon",coordinates:[[[[116.497345,35.263843],[116.509537382813,35.2604201484376],[116.500767851563,35.2516506171875],[116.497345,35.263843]]],[[[116.497345,35.263843],[116.47271609375,35.2484706855469],[116.417345,35.223843],[116.394073515625,35.2325868964844],[116.3245715625,35.2255019355469],[116.30474734375,35.179790265625],[116.267345,35.193843],[116.278726835938,35.2215419746094],[116.268551054688,35.2730336738281],[116.224205351563,35.2642702460938],[116.213170195313,35.2796681953125],[116.201519804688,35.2880178046875],[116.183170195313,35.3195497871094],[116.227349882813,35.3730837226563],[116.211519804688,35.3980178046875],[116.19810671875,35.4649221015625],[116.161910429688,35.4577687812501],[116.127574492188,35.4795680976563],[116.117345,35.493843],[116.1120325,35.5790944648438],[116.12283328125,35.58874534375],[116.107808867188,35.6163893867188],[116.127345,35.633843],[116.201871367188,35.6265138984375],[116.302345,35.6184413886719],[116.312584257813,35.6192641425781],[116.327345,35.613843],[116.331641875,35.5865883613281],[116.353013945313,35.555630109375],[116.373116484375,35.5601369453125],[116.38142703125,35.5379274726563],[116.397345,35.5138430000001],[116.402271757813,35.4715859199219],[116.448404570313,35.4537929511719],[116.456329375,35.4136684394532],[116.442506132813,35.3447096992188],[116.413170195313,35.3236830878906],[116.451519804688,35.2880178046875],[116.490904570313,35.2728273750001],[116.497345,35.263843]]]]}},{type:"Feature",properties:{name:"金乡县",id:"370828"},geometry:{type:"MultiPolygon",coordinates:[[[[116.433204375,35.1937734199219],[116.477135039063,35.178802716797],[116.491158476563,35.1376552558594],[116.507345,35.1338430000001],[116.502628203125,35.1285622382813],[116.413082304688,35.1165859199219],[116.432994414063,35.0987953925781],[116.3841028125,35.067700421875],[116.402061796875,35.0285622382813],[116.414268828125,35.0061037421875],[116.410933867188,34.9501784492188],[116.432628203125,34.9191237617188],[116.437345,34.893843],[116.41170046875,34.8594863105469],[116.407345,34.843843],[116.373170195313,34.8596681953125],[116.281519804688,34.8780178046875],[116.253170195313,34.8996681953125],[116.198316679688,34.9085353828125],[116.183170195313,34.9296681953125],[116.177345,34.9338430000001],[116.15080203125,34.9414321113282],[116.154898710938,34.9743886542969],[116.111793242188,35.0282900214844],[116.102896757813,35.0456484199219],[116.132896757813,35.0582900214845],[116.141793242188,35.0993959785156],[116.147345,35.113843],[116.185045195313,35.1184499335938],[116.214732695313,35.1676723457032],[116.210494414063,35.196352765625],[116.232379179688,35.1995864082032],[116.267345,35.193843],[116.30474734375,35.179790265625],[116.3245715625,35.2255019355469],[116.394073515625,35.2325868964844],[116.417345,35.223843],[116.433204375,35.1937734199219]]]]}},{type:"Feature",properties:{name:"梁山县",id:"370832"},geometry:{type:"MultiPolygon",coordinates:[[[[116.054483671875,35.9683315253906],[116.051529570313,35.9483315253907],[116.06298953125,35.9394863105469],[116.083516875,35.9051638007813],[116.142569609375,35.8879457832031],[116.16615359375,35.902173078125],[116.20478640625,35.88698753125],[116.22295046875,35.8896718574219],[116.237159453125,35.8223366523437],[116.293170195313,35.7994130683594],[116.291226835938,35.7862831855469],[116.307345,35.7738430000001],[116.325030546875,35.7509291816406],[116.358448515625,35.7372524238281],[116.340714140625,35.7078493476563],[116.321314726563,35.6584987617188],[116.34093875,35.6433498359375],[116.34459109375,35.6186452460938],[116.327345,35.613843],[116.312584257813,35.6192641425781],[116.302345,35.6184413886719],[116.201871367188,35.6265138984375],[116.127345,35.633843],[116.1058215625,35.6854323554688],[115.997222929688,35.7701357246094],[115.892061796875,35.8085622382813],[115.862628203125,35.8228224921876],[115.877345,35.863843],[115.885933867188,35.8867067695313],[115.853267851563,35.913843],[115.90388796875,35.9286977363281],[115.900386992188,35.9630373359375],[115.992345,35.9724098945313],[116.032608671875,35.968305890625],[116.047345,35.9738430000001],[116.054483671875,35.9683315253906]]]]}},{type:"Feature",properties:{name:"曲阜市",id:"370881"},geometry:{type:"MultiPolygon",coordinates:[[[[116.996295195313,35.8151113105469],[117.0249621875,35.794985578125],[117.042345,35.8004006171875],[117.057345,35.795727765625],[117.089928007813,35.8058779121094],[117.101158476563,35.7876552558594],[117.123531523438,35.7800307441407],[117.127345,35.7738430000001],[117.104097929688,35.7552248359375],[117.091632109375,35.6695839667969],[117.092965117188,35.6588430000001],[117.091724882813,35.648843],[117.094000273438,35.6305165839844],[117.132896757813,35.6193959785157],[117.145211210938,35.590171125],[117.191807890625,35.5768483710938],[117.211793242188,35.5634194160157],[117.188546171875,35.523872296875],[117.222896757813,35.5093959785157],[117.231793242188,35.4982900214844],[117.237345,35.493843],[117.231783476563,35.4493959785156],[117.181793242188,35.4582900214844],[117.158428984375,35.4874648261719],[117.141983671875,35.4895095039063],[117.118892851563,35.4759352851563],[117.061793242188,35.4882900214844],[117.018580351563,35.5048989082032],[116.978785429688,35.4881288886719],[116.956143828125,35.4598537421876],[116.922896757813,35.4793959785156],[116.887345,35.483843],[116.844420195313,35.5484853339844],[116.853468046875,35.5888430000001],[116.847789335938,35.6141677070313],[116.86408328125,35.6391909003907],[116.85142703125,35.6479274726563],[116.84326296875,35.6620009589844],[116.862345,35.6577223945313],[116.876939726563,35.6609938789063],[116.867345,35.683843],[116.873531523438,35.6876552558595],[116.881158476563,35.7000307441406],[116.946070585938,35.7218752265626],[116.9386340625,35.7457619453126],[116.977135039063,35.7588832832032],[116.996295195313,35.8151113105469]]]]}},{type:"Feature",properties:{name:"任城区",id:"370811"},geometry:{type:"MultiPolygon",coordinates:[[[[116.497345,35.263843],[116.500767851563,35.2516506171875],[116.509537382813,35.2604201484376],[116.490904570313,35.2728273750001],[116.451519804688,35.2880178046875],[116.413170195313,35.3236830878906],[116.442506132813,35.3447096992188],[116.456329375,35.4136684394532],[116.448404570313,35.4537929511719],[116.402271757813,35.4715859199219],[116.397345,35.5138430000001],[116.42388796875,35.5214321113281],[116.420186796875,35.5511855292969],[116.528819609375,35.5358925605469],[116.567545195313,35.558657453125],[116.597345,35.563843],[116.609595976563,35.5460964179687],[116.65326296875,35.5297585273438],[116.66142703125,35.5079274726563],[116.68326296875,35.4797585273438],[116.69142703125,35.4479274726563],[116.70408328125,35.4284950996094],[116.68435671875,35.4148744941407],[116.74326296875,35.3997585273438],[116.747345,35.3938430000001],[116.756641875,35.3559828925781],[116.747345,35.333843],[116.74197390625,35.3292153144532],[116.6818371875,35.2514784980469],[116.633043242188,35.2860744453125],[116.613917265625,35.3289321113281],[116.573306914063,35.3384706855469],[116.56271609375,35.2650612617188],[116.58271609375,35.2292153144531],[116.597345,35.1638430000001],[116.5593371875,35.1726503730469],[116.507345,35.1338430000001],[116.491158476563,35.1376552558594],[116.477135039063,35.178802716797],[116.433204375,35.1937734199219],[116.417345,35.223843],[116.47271609375,35.2484706855469],[116.497345,35.263843]],[[116.631246367188,35.3927431464844],[116.619874296875,35.4323647285156],[116.602345,35.4274379707032],[116.574976835938,35.4351296210938],[116.55072390625,35.4196059394531],[116.55375125,35.408843],[116.546197539063,35.3819753242188],[116.562345,35.3774379707032],[116.584771757813,35.3837404609375],[116.607345,35.373843],[116.611246367188,35.3799404121094],[116.631246367188,35.3927431464844]]]]}},{type:"Feature",properties:{name:"微山县",id:"370826"},geometry:{type:"MultiPolygon",coordinates:[[[[117.247345,34.473843],[117.243922148438,34.4860353828125],[117.235152617188,34.4772658515625],[117.242896757813,34.4582900214844],[117.221793242188,34.4493959785157],[117.187769804688,34.4293959785157],[117.157027617188,34.4399221015625],[117.131651640625,34.5287795234375],[117.137345,34.5538430000001],[117.146168242188,34.5599355292969],[117.115513945313,34.6070119453125],[117.101573515625,34.6442739082032],[117.064146757813,34.635884015625],[117.05326296875,34.6841188789062],[117.074283476563,34.6986330390626],[117.008360625,34.7713124824219],[116.987345,34.7666017890626],[116.965933867188,34.7714003730469],[116.94654421875,34.7994826484375],[116.967345,34.813843],[116.970767851563,34.8016506171876],[116.979537382813,34.8104201484376],[116.967345,34.813843],[116.960904570313,34.8357949042969],[116.9232434375,34.8521279121094],[116.943541289063,34.8689882636719],[116.921881132813,34.8783803535156],[116.912808867188,34.8993056464844],[116.891881132813,34.9083803535156],[116.862691679688,34.9293886542969],[116.824298125,34.925473859375],[116.817345,34.9338430000001],[116.811812773438,34.965639875],[116.765948515625,34.984966046875],[116.709932890625,35.0297646308594],[116.641793242188,35.0682900214844],[116.625269804688,35.1074953437501],[116.604215117188,35.1243556953125],[116.597345,35.1638430000001],[116.58271609375,35.2292153144531],[116.56271609375,35.2650612617188],[116.573306914063,35.3384706855469],[116.613917265625,35.3289321113281],[116.633043242188,35.2860744453125],[116.6818371875,35.2514784980469],[116.74197390625,35.3292153144532],[116.747345,35.333843],[116.757906523438,35.3244057441407],[116.776783476563,35.3032802558594],[116.795484648438,35.2865724921875],[116.782628203125,35.2585622382813],[116.761822539063,35.2287783027344],[116.781929960938,35.2108119941407],[116.7826575,35.1986171699219],[116.762838164063,35.1621498847657],[116.807345,35.153843],[116.81298953125,35.1494863105469],[116.82677859375,35.1316237617188],[116.883780546875,35.0919802070313],[116.90170046875,35.0481996894532],[116.91298953125,35.0394863105469],[116.92170046875,35.0281996894532],[116.950484648438,35.0164174628907],[116.953140898438,34.998452375],[116.94088015625,34.9781276679688],[116.972857695313,34.9367018867188],[117.016832304688,34.9432009101563],[117.045889921875,34.9256728339844],[117.103331328125,34.9341616035156],[117.12568484375,34.853891828125],[117.165343046875,34.8299697089844],[117.187345,34.8238430000001],[117.182896757813,34.8182900214844],[117.163448515625,34.8027150703125],[117.16166140625,34.788344953125],[117.182896757813,34.7793959785157],[117.2476184375,34.7276332832032],[117.262706328125,34.7295095039063],[117.281983671875,34.7181764960938],[117.299249296875,34.7203237128907],[117.312896757813,34.7093959785157],[117.331793242188,34.6782900214845],[117.342896757813,34.6693959785157],[117.351793242188,34.6582900214844],[117.362896757813,34.6493959785156],[117.371846953125,34.62815940625],[117.390181914063,34.6304396796876],[117.407345,34.623843],[117.39142703125,34.5997585273438],[117.387345,34.573843],[117.359718046875,34.5851955390625],[117.298580351563,34.5666237617188],[117.2758215625,34.5711208320313],[117.257823515625,34.4813539863282],[117.247345,34.473843]]]]}},{type:"Feature",properties:{name:"鱼台县",id:"370827"},geometry:{type:"MultiPolygon",coordinates:[[[[116.811812773438,34.965639875],[116.817345,34.9338430000001],[116.781783476563,34.9396852851563],[116.771143828125,34.9136940742188],[116.727345,34.923843],[116.703170195313,34.9296681953125],[116.6318371875,34.9380178046875],[116.583170195313,34.9180178046875],[116.483370390625,34.8980361152344],[116.437345,34.893843],[116.432628203125,34.9191237617188],[116.410933867188,34.9501784492188],[116.414268828125,35.0061037421875],[116.402061796875,35.0285622382813],[116.3841028125,35.067700421875],[116.432994414063,35.0987953925781],[116.413082304688,35.1165859199219],[116.502628203125,35.1285622382813],[116.507345,35.1338430000001],[116.5593371875,35.1726503730469],[116.597345,35.1638430000001],[116.604215117188,35.1243556953125],[116.625269804688,35.1074953437501],[116.641793242188,35.0682900214844],[116.709932890625,35.0297646308594],[116.765948515625,34.984966046875],[116.811812773438,34.965639875]]]]
}},{type:"Feature",properties:{name:"邹城市",id:"370883"},geometry:{type:"MultiPolygon",coordinates:[[[[117.061793242188,35.4882900214844],[117.118892851563,35.4759352851563],[117.141983671875,35.4895095039063],[117.158428984375,35.4874648261719],[117.181793242188,35.4582900214844],[117.231783476563,35.4493959785156],[117.237345,35.493843],[117.286475859375,35.4826821113282],[117.327345,35.4775991035157],[117.342564726563,35.4794924140626],[117.381793242188,35.4682900214844],[117.427345,35.453843],[117.443975859375,35.4410060859375],[117.467423125,35.4021315742188],[117.43298953125,35.3450429511719],[117.44170046875,35.3281996894532],[117.47170046875,35.3159206367187],[117.459327421875,35.2907521796875],[117.417345,35.273843],[117.405694609375,35.282192609375],[117.388155546875,35.3066640449219],[117.311890898438,35.3219533515625],[117.307345,35.293843],[117.262388945313,35.2883290839844],[117.250748320313,35.2895156074219],[117.252901640625,35.2683974433594],[117.201881132813,35.2593056464844],[117.192808867188,35.2483803535156],[117.1381653125,35.2323451972656],[117.01685671875,35.2187416816406],[116.949893828125,35.1765444160156],[116.917345,35.1798622871094],[116.901954375,35.1782936835938],[116.888721953125,35.1942263007813],[116.852398710938,35.1680849433594],[116.81740359375,35.1881264472656],[116.807345,35.153843],[116.762838164063,35.1621498847657],[116.7826575,35.1986171699219],[116.781929960938,35.2108119941407],[116.761822539063,35.2287783027344],[116.782628203125,35.2585622382813],[116.795484648438,35.2865724921875],[116.776783476563,35.3032802558594],[116.757906523438,35.3244057441407],[116.747345,35.333843],[116.756641875,35.3559828925781],[116.747345,35.3938430000001],[116.78763796875,35.3980873847657],[116.806300078125,35.42837425],[116.841949492188,35.4405239082032],[116.85287234375,35.4371218085938],[116.881871367188,35.460610578125],[116.887345,35.483843],[116.922896757813,35.4793959785156],[116.956143828125,35.4598537421876],[116.978785429688,35.4881288886719],[117.018580351563,35.5048989082032],[117.061793242188,35.4882900214844]]]]}},{type:"Feature",properties:{name:"兖州区",id:"370882"},geometry:{type:"MultiPolygon",coordinates:[[[[116.715318632813,35.7003395820313],[116.737345,35.6975991035157],[116.761890898438,35.7006520820313],[116.786920195313,35.6693959785157],[116.803018828125,35.6884316230469],[116.801241484375,35.7027260566407],[116.867345,35.683843],[116.876939726563,35.6609938789063],[116.862345,35.6577223945313],[116.84326296875,35.6620009589844],[116.85142703125,35.6479274726563],[116.86408328125,35.6391909003907],[116.847789335938,35.6141677070313],[116.853468046875,35.5888430000001],[116.844420195313,35.5484853339844],[116.887345,35.483843],[116.881871367188,35.460610578125],[116.85287234375,35.4371218085938],[116.841949492188,35.4405239082032],[116.806300078125,35.42837425],[116.78763796875,35.3980873847657],[116.747345,35.3938430000001],[116.74326296875,35.3997585273438],[116.68435671875,35.4148744941407],[116.70408328125,35.4284950996094],[116.69142703125,35.4479274726563],[116.68326296875,35.4797585273438],[116.66142703125,35.5079274726563],[116.65326296875,35.5297585273438],[116.609595976563,35.5460964179687],[116.597345,35.563843],[116.59084109375,35.5807656074219],[116.621793242188,35.6334194160156],[116.612896757813,35.6593959785157],[116.593355742188,35.6926406074219],[116.607345,35.7038430000001],[116.632896757813,35.7082900214844],[116.682589140625,35.7195778632813],[116.715318632813,35.7003395820313]]]]}},{type:"Feature",properties:{name:"汶上县",id:"370830"},geometry:{type:"MultiPolygon",coordinates:[[[[116.681016875,35.8160927558595],[116.683082304688,35.7814577460937],[116.66259890625,35.7585305],[116.625094023438,35.7607656074219],[116.612061796875,35.7491237617188],[116.607345,35.7038430000001],[116.593355742188,35.6926406074219],[116.612896757813,35.6593959785157],[116.621793242188,35.6334194160156],[116.59084109375,35.5807656074219],[116.597345,35.563843],[116.567545195313,35.558657453125],[116.528819609375,35.5358925605469],[116.420186796875,35.5511855292969],[116.42388796875,35.5214321113281],[116.397345,35.5138430000001],[116.38142703125,35.5379274726563],[116.373116484375,35.5601369453125],[116.353013945313,35.555630109375],[116.331641875,35.5865883613281],[116.327345,35.613843],[116.34459109375,35.6186452460938],[116.34093875,35.6433498359375],[116.321314726563,35.6584987617188],[116.340714140625,35.7078493476563],[116.358448515625,35.7372524238281],[116.325030546875,35.7509291816406],[116.307345,35.7738430000001],[116.311519804688,35.7796681953125],[116.342393828125,35.8017971015625],[116.367345,35.7968666816407],[116.382345,35.7998305488281],[116.417056914063,35.7929714179688],[116.461519804688,35.8296681953126],[116.533980742188,35.8441957832032],[116.554678984375,35.8978639960937],[116.593170195313,35.9080178046875],[116.607603789063,35.9281581855469],[116.633170195313,35.9380178046875],[116.637345,35.943843],[116.667345,35.943843],[116.667345,35.9238430000001],[116.661265898438,35.9041493964844],[116.602857695313,35.8519655585938],[116.681016875,35.8160927558595]]]]}},{type:"Feature",properties:{name:"泗水县",id:"370831"},geometry:{type:"MultiPolygon",coordinates:[[[[117.332896757813,35.7893959785156],[117.365318632813,35.7703395820313],[117.382345,35.7682216621094],[117.40982546875,35.7716396308594],[117.446060820313,35.7451735664063],[117.491793242188,35.7182900214844],[117.52302859375,35.7093581367187],[117.520533476563,35.6892958808594],[117.532896757813,35.6793959785156],[117.541793242188,35.6682900214845],[117.587345,35.633843],[117.580753203125,35.6036305976563],[117.584849882813,35.5526601386719],[117.527345,35.5480397773438],[117.492906523438,35.5508071113281],[117.4919153125,35.5385195136719],[117.52197390625,35.5126247382813],[117.488834257813,35.5079201484375],[117.45986453125,35.5102480292969],[117.427345,35.453843],[117.381793242188,35.4682900214844],[117.342564726563,35.4794924140626],[117.327345,35.4775991035157],[117.286475859375,35.4826821113282],[117.237345,35.493843],[117.231793242188,35.4982900214844],[117.222896757813,35.5093959785157],[117.188546171875,35.523872296875],[117.211793242188,35.5634194160157],[117.191807890625,35.5768483710938],[117.145211210938,35.590171125],[117.132896757813,35.6193959785157],[117.094000273438,35.6305165839844],[117.091724882813,35.648843],[117.092965117188,35.6588430000001],[117.091632109375,35.6695839667969],[117.104097929688,35.7552248359375],[117.127345,35.7738430000001],[117.172345,35.7794655585938],[117.245382109375,35.7703798652344],[117.297345,35.793843],[117.332896757813,35.7893959785156]]]]}},{type:"Feature",properties:{id:"????",zOffset:1.01,name:"高新区"},geometry:{type:"Polygon",coordinates:[[[116.62547185527754,35.477937197755985],[116.66969705548743,35.47938720432025],[116.67743042383015,35.48712057266296],[116.69217215723344,35.487362240423664],[116.70715555839746,35.48446222729515],[116.72213895956146,35.48252888520947],[116.73349734431483,35.48156221416663],[116.74316405474322,35.481078878645214],[116.75210576188948,35.4832538884916],[116.76539748872851,35.4883289114665],[116.77264752154981,35.491712260116444],[116.79343094897085,35.49267893115928],[116.79802263642434,35.49122892459502],[116.80865601789557,35.48687890490225],[116.82122274145247,35.48301222073089],[116.83088945188086,35.48059554312379],[116.83693114589862,35.47213717149895],[116.84055616230927,35.46778715180617],[116.84708119184843,35.46440380315624],[116.84490618200203,35.456670434813525],[116.839106155745,35.44555371782087],[116.83330612948797,35.44096203036739],[116.83596447485577,35.437337013956736],[116.83306446172726,35.43588700739248],[116.81397270863118,35.43467866858893],[116.80285599163854,35.41993693518563],[116.7948809555351,35.41341190564647],[116.78618091614956,35.402053520893105],[116.77820588004613,35.39625349463607],[116.75283076517161,35.39504515583253],[116.74437239354677,35.39552849135394],[116.74944741652168,35.392145142704],[116.7479974099574,35.38876179405407],[116.74896408100025,35.37788674482213],[116.75113909084664,35.3672533633509],[116.75331410069303,35.3600033305296],[116.75379743621444,35.34936994905837],[116.73857236728973,35.335111551176496],[116.73325567655411,35.33825323206572],[116.72721398253637,35.334869883415784],[116.71658060106513,35.331728202526556],[116.708363897201,35.32689484731236],[116.6957971736441,35.32254482761958],[116.6861304632157,35.32278649538029],[116.67984710143725,35.32979486044088],[116.67114706205169,35.33438654789436],[116.6687303844446,35.345503264887014],[116.65495532208413,35.35202829442618],[116.6368302400309,35.35541164307612],[116.62426351647399,35.36652836006877],[116.62088016782405,35.37305338960793],[116.62136350334548,35.382961767797035],[116.62571352303826,35.390453468379036],[116.62668019408109,35.41268690236434],[116.6218468388669,35.42356195159628],[116.62063850006335,35.444828714538744],[116.61508014156702,35.45304541840287],[116.62015516454193,35.46222879330985],[116.62353851319186,35.466337145241916],[116.62402184871328,35.47237883925966],[116.62402184871328,35.47237883925966],[116.62547185527754,35.477937197755985]]]}},{type:"Feature",properties:{id:"????",zOffset:1.02,name:"太白湖区"},geometry:{type:"Polygon",coordinates:[[[116.54257981335407,35.3452615971263],[116.54644649752541,35.34501992936559],[116.55007151393605,35.35226996218689],[116.5512798527396,35.35976166276889],[116.55683821123593,35.36169500485457],[116.56529658286077,35.364836685743796],[116.58970502669246,35.36532002126522],[116.59913006936014,35.3672533633509],[116.60493009561718,35.37208671856509],[116.6201551645419,35.37257005408651],[116.6228135099097,35.371361715282966],[116.62643852632036,35.36628669230806],[116.62982187497029,35.358553323965346],[116.63683024003087,35.35541164307612],[116.6549553220841,35.352994965469016],[116.66897205220528,35.345744932647726],[116.66993872324811,35.33583655445862],[116.6820221112836,35.32931152491946],[116.68637213097638,35.323269830901715],[116.70087219661897,35.322303159858876],[116.71029723928665,35.327378182833776],[116.72914732462202,35.33656155774075],[116.73398067983621,35.33849489982643],[116.73881403505041,35.33414488013366],[116.73446401535764,35.329553192680166],[116.7356723541612,35.319886482251775],[116.72866398910061,35.31070310734481],[116.72697231477564,35.30055306139499],[116.7187556109115,35.29668637722364],[116.70981390376524,35.293303028573696],[116.70739722615815,35.286777999034534],[116.70038886109757,35.2734862721955],[116.6866137987371,35.260194545356455],[116.676705420548,35.25246117701374],[116.66752204564102,35.25777786774936],[116.65229697671631,35.27711128860614],[116.64504694389501,35.2809779727775],[116.62933853944888,35.29040301544518],[116.6274051973632,35.311669778387646],[116.62402184871327,35.31456979151616],[116.61556347708841,35.314811459276875],[116.61338846724203,35.321094821055325],[116.60928011530997,35.331486534765844],[116.60613843442074,35.332936541330106],[116.58970502669247,35.33100319924443],[116.5756882965713,35.3278615183552],[116.56457157957865,35.32520317298739],[116.56432991181795,35.31940314673036],[116.55152152050033,35.32351149866243],[116.54257981335407,35.32931152491946],[116.54257981335407,35.3452615971263]]]}},{type:"Feature",properties:{id:"????",zOffset:1.03,name:"济宁高新区"},geometry:{type:"Polygon",coordinates:[[[116.61773527968005,35.57967054900415],[116.61090136704306,35.552790492631964],[116.60816780198826,35.527732812962974],[116.61864646803164,35.50313072746979],[116.61955765638325,35.486273742965196],[116.61500171462525,35.457571309889815],[116.61545730880106,35.43615838362722],[116.61910206220745,35.42385734088063],[116.63413667000884,35.41565664571623],[116.64507093022803,35.40563357384864],[116.66056113220523,35.39652169033264],[116.67240658077601,35.39105456022305],[116.68334084099521,35.38832099516825],[116.6915415361596,35.393788125277844],[116.7015646080272,35.40472238549704],[116.70566495560941,35.414289863188834],[116.7120432740706,35.42522412340803],[116.7152324333012,35.43205803604503],[116.71614362165279,35.44299229626422],[116.7152324333012,35.453015368131815],[116.72388872264139,35.45848249824141],[116.7334562003332,35.46167165747201],[116.74165689549758,35.46486081670261],[116.75031318483778,35.46850557010901],[116.75988066252957,35.473517106042806],[116.77354848780357,35.4789842361524],[116.78357155967116,35.48627374296518],[116.79997295,35.49310765560218],[116.81728552868034,35.503130727469774],[116.82913097725114,35.50950904593097],[116.82138587626254,35.51953211779857],[116.81318518109815,35.53319994307256],[116.80589567428535,35.54003385570955],[116.79450581989036,35.544134203291755],[116.78083799461636,35.54960133340135],[116.76762576351817,35.555524057686746],[116.75532472077157,35.55734643438995],[116.73937892461858,35.55825762274154],[116.7289002585752,35.560079999444746],[116.7211551575866,35.566913912081745],[116.7106764915432,35.57420341889454],[116.6970086662692,35.58012614317993],[116.68880797110481,35.581948519883134],[116.67468455165502,35.584226490762134],[116.66375029143582,35.584226490762134],[116.65053806033762,35.584226490762134],[116.63185869912984,35.58331530241053],[116.61773527968005,35.57967054900415]]]}}]}},function(t,e,i){var n=i(3),o=i(4),r=(i(5),i(11)),s=i(6),a=i(18),c=i(30),h=i(31),u=(Math.PI/180,function(t){s.call(this,t),this._stage3d.camera.position.set(1.040979539658803,-233.3660825660172,585.2495890199206),this._controls.target.set(-3.558668331040008,-71.01040694836026,-31.175877370524628),this._controls.update(),this._columns=[]});u.prototype=o(s.prototype,r.prototype,{constructor:u,_map:null,_vertices:void 0,_vertexMap:void 0,_edges:void 0,_textures:void 0,_initLight:function(){this._addLight(16777215,.5,800,0,100),this._addLight(16777215,.5,-800,0,100),this._addLight(16777215,.5,0,800,100),this._addLight(16777215,.5,0,-800,100),this._addLight(16777215,.75,0,0,800)},_initObject:function(){var t=this,e=new a;e.idField="name",e.mapData=this._parameters.mapData||i(28),e.strokeColor=10802930,e.fillColor=15135484,e.labelFillColor=5282240,e.labelStrokeColor=0,e.highlightColor=16774836,e.scaleX=552.3,e.scaleY=612.8,e.scaleZ=10.1,this._map=e,this._stage3d.addObject(this._map),e.on("itemClick",function(e){t.dispatchEvent({type:"mapItemClick",mouseEvent:e.mouseEvent,index:e.index,feature:e.feature,item:e.data})}),e.on("itemMouseOut",function(e){t.dispatchEvent({type:"mapItemMouseOut",mouseEvent:e.mouseEvent,item:e.data})}),e.on("itemMouseOver",function(e){t.dispatchEvent({type:"mapItemMouseOver",mouseEvent:e.mouseEvent,index:e.index,feature:e.feature,item:e.data})}),this.columnData=this._parameters.columnData||[],this.mapItemData=this._parameters.mapItemData||[]},_invalidateTextureFlag:!1,_invalidateTexture:function(){this._invalidateTextureFlag||(this._invalidateTextureFlag=!0,this.invalidateProperties())},_invalidateGeometryFlag:!1,_invalidateGeometry:function(){this._invalidateGeometryFlag||(this._invalidateGeometryFlag=!0,this.invalidateProperties())},get mapItemData(){return this._map.itemData},set mapItemData(t){this._map.itemData=t},_vertexTextures:void 0,get vertexTextures(){return this._vertexTextures},set vertexTextures(t){this._vertexTextures=t,this._invalidateTexture()},_vertexData:void 0,get vertexData(){return this._vertexData},set vertexData(t){this._vertexData=t,this._invalidateGeometry()},_edgeData:void 0,get edgeData(){return this._edgeData},set edgeData(t){this._edgeData=t,this._invalidateGeometry()},commitProperties:function(){var t=this;if(this._invalidateGeometryFlag){this._vertices&&this._vertices.forEach(function(e){e.dispatcher=null,e.disappear(0,500,function(){t._stage3d.removeObject(this)})}),this._vertices=[],this._vertexMap={};var e=0;this._vertexData.forEach(function(i){var n=t._map.lonLatToXY(i.longitude,i.latitude),o=new c;o.dispatcher=t,o.item=i,o.scaleValue=40,o.position.x=n.x,o.position.y=n.y,o.position.z=t._map.scaleZ+o.scaleValue/2,o.appear(e,800),t._stage3d.addObject(o),t._vertices.push(o),t._vertexMap[i.id]=o,e+=10}),this._edges&&this._edges.forEach(function(e){e.dispatcher=null,e.disappear(0,500,function(){t._stage3d.removeObject(this)})}),this._edges=[],this._edgeData.forEach(function(e){var i=t._vertexMap[e.source],o=t._vertexMap[e.target];if(!i||!o)return void console.warn("Can NOT create edge for item: ",e);var r=i.position,s=o.position,a=r.clone().add(s);a.multiplyScalar(.5);var c=Math.atan2(s.x-r.x,s.y-r.y)+Math.PI/2,u=new n.Vector3(a.x+Math.cos(c),a.y+Math.sin(c),0).normalize(),l=r.distanceTo(s)/15*3,d=new h;"number"==typeof e.color0&&d.setStartColor(e.color0),"number"==typeof e.color1&&d.setEndColor(e.color1),d.setFlatVector(u),d.setLineWeight(e.thickness||10);for(var f=60,p=0;p<f;p++){var m=p/(f-1);d.addPoint(new n.Vector3(r.x+(s.x-r.x)*m,r.y+(s.y-r.y)*m,r.z+(s.z-r.z)*m+l*Math.sin(m*Math.PI)))}t._stage3d.addObject(d),t._edges.push(d),d.appear()}),this._invalidateGeometryFlag=!1}this._invalidateTextureFlag&&(this._textures=this._vertexTextures.map(function(t){var e=(new n.TextureLoader).load(t);return e.magFilter=n.NearestFilter,e.minFilter=n.LinearMipMapLinearFilter,e}),this._vertices.forEach(function(e){var i=e.item;e.textureNormal=t._textures[i.normalTextureIndex],e.textureEmphasis=t._textures[i.emphasisTextureIndex]}),this._invalidateTextureFlag=!1)}}),t.exports=u},function(t,e,i){function n(){o.Sprite.call(this),this.material.depthWrite=!1,this.material.transparent=!0,this.interactive=!0,this._scaleT=0}var o=i(3),r=i(11),s=i(5),a=i(4),c=i(7);n.prototype=a(o.Sprite.prototype,r.prototype,s.prototype,{constructor:n,_scaleT:0,dispatcher:void 0,item:void 0,_invalidateGeometryFlag:!1,_invalidateGeometry:function(){this._invalidateGeometryFlag||(this._invalidateGeometryFlag=!0,this.invalidateProperties())},_textureNormal:void 0,get textureNormal(){return this._textureNormal},set textureNormal(t){this._textureNormal=t,this._invalidateGeometry()},_textureEmphasis:void 0,get textureEmphasis(){return this._textureEmphasis},set textureEmphasis(t){this._textureEmphasis=t,this._invalidateGeometry()},_scaleValue:void 0,get scaleValue(){return this._scaleValue},set scaleValue(t){this._scaleValue=t,this._updateScale()},_updateScale:function(){var t=Math.max(this._scaleValue*this._scaleT,.01);this.scale.set(t,t,t)},commitProperties:function(){this._invalidateGeometryFlag&&(this.material.map=this._textureNormal)},appear:function(t,e){var i=this;new c.Tween(this).to({_scaleT:1},e||1e3).delay(t||0).onUpdate(function(){i._updateScale()}).start()},disappear:function(t,e,i){var n=this;new c.Tween(this).to({_scaleT:0},e||1e3).delay(t||0).onUpdate(function(){n._updateScale()}).onComplete(function(){"function"==typeof i&&i.call(n)}).start()},mouseOut:function(t){this.material.map=this._textureNormal;var e=this.dispatcher||this;e.dispatchEvent({type:"vertexItemMouseOut",mouseEvent:t})},mouseOver:function(t){this.material.map=this._textureEmphasis;var e=this.dispatcher||this;e.dispatchEvent({type:"vertexItemMouseOver",mouseEvent:t,item:this.item})},click:function(t){var e=this.dispatcher||this;e.dispatchEvent({type:"vertexItemClick",mouseEvent:t,item:this.item})}}),t.exports=n},function(t,e,i){function n(){o.call(this),this.interactive=!0}var o=(i(3),i(32)),r=i(4);i(7);n.prototype=r(o.prototype,{constructor:n,dispatcher:void 0,item:void 0,mouseOut:function(t){var e=this.dispatcher||this;e.dispatchEvent({type:"edgeItemMouseOut",mouseEvent:t})},mouseOver:function(t){var e=this.dispatcher||this;e.dispatchEvent({type:"edgeItemMouseOver",mouseEvent:t,item:this.item})},click:function(t){var e=this.dispatcher||this;e.dispatchEvent({type:"edgeItemClick",mouseEvent:t,item:this.item})}}),t.exports=n},function(t,e,i){var n=i(3),o=i(4),r=i(11),s=i(5),a=i(7),c=2*Math.PI,h=["uniform bool positive;","uniform float t;","uniform float factor;","uniform float alpha;","uniform float flatSize;","uniform vec3 flatVector;","attribute vec3 point;","attribute float i;","attribute float offset;","attribute vec3 color;","attribute float flatCoef;","varying vec3 vColor;","varying float vAlpha;","void main() {","    vAlpha = ((positive && i <= t) || (!positive && i >= t)) ? alpha : 0.0;","    float coef2 = 0.5 + (cos(factor + offset) + 1.0) / 2.0 * 0.5;","    vAlpha = vAlpha * coef2;","    vColor = color;","    float coef3 = 0.3 + (sin(factor / 3.0 + offset) + 1.0) / 2.0 * 0.7;","    float coef4 = sin(i * 3.14);","    vec3 mvPosition = point + flatVector * flatCoef * flatSize * coef3 * coef4;","    gl_Position = projectionMatrix * modelViewMatrix * vec4(mvPosition, 1.0);","}"].join("\n"),u=["varying vec3 vColor;","varying float vAlpha;","void main() {","    gl_FragColor = vec4(vColor, vAlpha);","}"].join("\n"),l=function(){n.Mesh.call(this),this._points=[],this.geometry=new n.BufferGeometry,this.geometry.addAttribute("position",new n.Float32Attribute(0,3)),this.material=new n.ShaderMaterial({uniforms:{positive:{type:"b",value:!0},t:{type:"f",value:0},alpha:{type:"f",value:1},factor:{type:"f",value:Math.random()*c},flatSize:{type:"f",value:1},flatVector:{type:"v",value:new n.Vector3}},vertexShader:h,fragmentShader:u,depthWrite:!1,transparent:!0,side:n.DoubleSide}),this.renderable=!0};l.prototype=o(n.Mesh.prototype,r.prototype,s.prototype,{constructor:l,_invalidateGeometryFlag:!1,_invalidateMaterialFlag:!1,_points:null,addPoint:function(t){if(!(t instanceof n.Vector3))throw new Error("Illegal parameter.");this._points instanceof Array||(this._points=[]),this._points.push(t),this._invalidateGeometryFlag||(this._invalidateGeometryFlag=!0,this.invalidateProperties())},_startColor:16711680,setStartColor:function(t){this._startColor=t,this._invalidateGeometryFlag=!0,this.invalidateProperties()},_endColor:255,setEndColor:function(t){this._endColor=t,this._invalidateGeometryFlag=!0,this.invalidateProperties()},_lineWeight:1,setLineWeight:function(t){this._lineWeight=t,this._invalidateMaterialFlag=!0,this.invalidateProperties()},_flatVector:null,setFlatVector:function(t){this._flatVector=t,this._invalidateMaterialFlag=!0,this.invalidateProperties()},_calculateDefaultDuration:function(){var t=this._points[0].distanceTo(this._points[this._points.length-1]),e=99.96;return 1e3*Math.max(2*t/e,.35)},appear:function(t,e,i){var n=this;e=e||1e3,this.material.uniforms.positive.value=!0,this.material.uniforms.t.value=0,new a.Tween(this.material.uniforms.t).to({value:1},e).delay(t||0).onUpdate(function(){}).onComplete(function(){"function"==typeof i&&i.call(n)}).start()},disappear:function(t,e,i){var n=this;this.material.uniforms.positive.value=!1,this.material.uniforms.t.value=0,new a.Tween(this.material.uniforms.t).to({value:1},e||1e3).delay(t||0).onUpdate(function(){}).onComplete(function(){i instanceof Function&&i.call(n)}).start()},reset:function(){this._points=[],this._lineWeight=1,this._flatVector=null;var t=this.geometry;t.removeAttribute("position"),t.removeAttribute("index"),t.removeAttribute("point"),t.removeAttribute("i"),t.removeAttribute("color"),t.removeAttribute("offset"),t.removeAttribute("flatCoef")},_fabulous:function(){this.material.uniforms.factor.value-=.1},render:function(){this._fabulous()},commitProperties:function(){if(this._invalidateGeometryFlag){this._invalidateGeometryFlag=!1;for(var t=[],e=[],i=[],o=[],r=[],s=Math.random()*c,a=[],h=[],u=new n.Color(this._startColor),l=new n.Color(this._endColor),d=new n.Color,f=this._points.length,p=0;p<f;p++){var m=this._points[p];if(t.push(m),t.push(m),e.push(new n.Vector3),e.push(new n.Vector3),p>0){var _=p-1;i.push(2*_,2*p,2*p+1),i.push(2*_,2*_+1,2*p+1)}var v=p/(f-1);o.push(v),o.push(v),d.setRGB(u.r+(l.r-u.r)*v,u.g+(l.g-u.g)*v,u.b+(l.b-u.b)*v),r.push(d.clone()),r.push(d.clone()),a.push(s+c*v),a.push(s+c*v),h.push(1),h.push(-1)}var g=this.geometry;g.removeAttribute("position"),g.addAttribute("position",new n.Float32Attribute(3*e.length,3).copyVector3sArray(e)),g.removeAttribute("index"),g.setIndex(new n.Uint32Attribute(i.length,1).copyArray(i)),g.removeAttribute("point"),g.addAttribute("point",new n.Float32Attribute(3*t.length,3).copyVector3sArray(t)),g.removeAttribute("i"),g.addAttribute("i",new n.Float32Attribute(o.length,1).copyArray(o)),g.removeAttribute("color"),g.addAttribute("color",new n.Float32Attribute(3*r.length,3).copyColorsArray(r)),g.removeAttribute("offset"),g.addAttribute("offset",new n.Float32Attribute(a.length,1).copyArray(a)),g.removeAttribute("flatCoef"),g.addAttribute("flatCoef",new n.Float32Attribute(h.length,1).copyArray(h))}if(this._invalidateMaterialFlag){this._invalidateMaterialFlag=!1;var b=this.material;b.uniforms.flatSize.value=this._lineWeight/2,b.uniforms.flatVector.value=this._flatVector}}}),t.exports=l},function(t,e,i){var n=i(3),o=function(){this._domain={min:0,max:1},this.colors(255,16711680)};o.prototype={constructor:o,_colors:void 0,colors:function(){return 0==arguments.length?this._colors:void(this._colors=Array.prototype.map.call(arguments,function(t){return new n.Color(t)}))},_domain:void 0,domain:function(t,e){if(0==arguments.length)return this._domain;if(t>e){var i=t;t=e,e=i}this._domain.min=t,this._domain.max=t==e?t+1:e},get:function(t){t=Math.min(this._domain.max,Math.max(this._domain.min,t));var e=(t-this._domain.min)/(this._domain.max-this._domain.min),i=(this._colors.length-1)*e,o=Math.floor(i),r=this._colors[o],s=Math.ceil(i),a=this._colors[s],c=i-o;return new n.Color(r.r+(a.r-r.r)*c,r.g+(a.g-r.g)*c,r.b+(a.b-r.b)*c)}},t.exports=o},function(t,e){var i=function(){this._domain={min:0,max:1},this._range={min:0,max:1}};i.prototype={constructor:i,_domain:void 0,domain:function(t,e){if(0==arguments.length)return this._domain;if(t>e){var i=t;t=e,e=i}this._domain.min=t,this._domain.max=t==e?t+1:e},_range:void 0,range:function(t,e){if(0==arguments.length)return this._range;if(t>e){var i=t;t=e,e=i}this._range.min=t,this._range.max=e},get:function(t){t=Math.min(this._domain.max,Math.max(this._domain.min,t));var e=(t-this._domain.min)/(this._domain.max-this._domain.min);return this._range.min+(this._range.max-this._range.min)*e}},t.exports=i},function(t,e,i){var n=i(36);n.webgl?console.log(["Jusfoun 3D Map Creator v0.1 - Jining City","Jusfoun Visualization Department "+(new Date).getFullYear(),"http://www.jusfoun.com"].join("\n")):console.error("This platform does NOT support WebGL."),e.webgl=n.webgl},function(t,e,i){var n={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var t=document.createElement("canvas");return!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(t){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var t=document.createElement("div");return t.id="webgl-error-message",t.style.fontFamily="monospace",t.style.fontSize="13px",t.style.fontWeight="normal",t.style.textAlign="center",t.style.background="#fff",t.style.color="#000",t.style.padding="1.5em",t.style.width="400px",t.style.margin="5em auto 0",this.webgl||(t.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),t},addGetWebGLMessage:function(t){var e,i,o;t=t||{},e=void 0!==t.parent?t.parent:document.body,i=void 0!==t.id?t.id:"oldie",o=n.getWebGLErrorMessage(),o.id=i,e.appendChild(o)}};t.exports=n}])});